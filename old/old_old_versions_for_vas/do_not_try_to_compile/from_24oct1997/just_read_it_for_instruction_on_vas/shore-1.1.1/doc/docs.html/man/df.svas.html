<!-- Warning: Do not edit this file. -->
<!-- It was created automatically by yam2html.pl 1.3  -->
<!-- on Mon Oct 27 09:40:59 CST 1997 from file mansvas/df.svas -->
<!DOCTYPE HTML public "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>
df(svas) -- Shore Reference Manual
</TITLE>
<LINK REV="made" HREF="mailto:solomon@cs.wisc.edu">
</HEAD>

<BODY>

<!-- .so tmac.man.local -->
<H1><A NAME="HRR.0">
df - Shore disk usage and free space report
</A></H1><HR>
<H1>
CONTENTS
</H1>
<UL>
<LI>
<A HREF="#HRR.1">SYNOPSIS</A>
</LI>
<LI>
<A HREF="#HRR.2">DESCRIPTION</A>
</LI>
<LI>
<A HREF="#HRR.3">ARGUMENTS</A>
</LI>
<LI>
<A HREF="#HRR.4">EXTENT and FILE STATISTICS</A>
</LI>
<LI>
<A HREF="#HRR.5">PAGE STATISTICS</A>
</LI>
<LI>
<A HREF="#HRR.6">BYTE STATISTICS</A>
<UL>
<LI>
<A HREF="#HRR.6.1">DEFINITIONS for BYTE STATISTICS</A>
</LI>
</UL>
</LI>
<LI>
<A HREF="#HRR.7">SUMMARY STATISTICS</A>
</LI>
<LI>
<A HREF="#HRR.8">BUGS</A>
</LI>
<LI>
<A HREF="#HRR.9">VERSION</A>
</LI>
<LI>
<A HREF="#HRR.10">SPONSORSHIP</A>
</LI>
<LI>
<A HREF="#HRR.11">COPYRIGHT</A>
</LI>
<LI>
<A HREF="#HRR.12">SEE ALSO</A>
</LI></UL><HR>
<H1><A NAME="HRR.1">SYNOPSIS</A></H1>
<BLOCKQUOTE><PRE>
df [-a | -s | -p | -b | -e]
</PRE></BLOCKQUOTE>
<HR>
<H1><A NAME="HRR.2">DESCRIPTION</A></H1>
 <strong>Df</strong>
is a command given to the Shore server's 
Tcl shell, and it prints voluminous information
about disk space utilization.
<HR>
<H1><A NAME="HRR.3">ARGUMENTS</A></H1>
<P>
 <em>-a</em>
causes all statistics to be printed.
<P>
 <em>-s</em>
causes only summary information to be printed.
<P>
 <em>-p</em>
reports statistics in units of pages.
<P>
 <em>-b</em>
reports statistics in units of bytes.
<P>
 <em>-e</em>
reports statistics about extents and files.
<P>
All statistics are computed and reported for one volume
at a time.
<HR>
<H1><A NAME="HRR.4">EXTENT and FILE STATISTICS</A></H1>
<P>
An 
<em>extent</em>
is a unit of allocation; 8 pages make an extent, and 
one extent is allocated to a Shore
Storage Manager  (SSM)
<em>file, B-tree, R-tree</em>
or
<em>RD-tree</em>
at a time.
In some cases, the server creates small
B-trees, which are handled specially,
and they are assigned one page rather
than a full extent.
These B-trees are converted, if necessary, to 
&quot;normal&quot; B-trees when they grow.
<P>
R-trees and RD-trees
cannot be
created by the Shore applications,
but the statistics are reported by the SSM
and printed by the Shore server.
<P>
When a Shore file system is created on a volume,
the Shore server
creates one file
for storing registered objects.
It also creates one file
for each 
<em>pool</em>
created by an application.
<P>
The statistics reported for files and extents are: 
<DL>
<DT>Files</DT><DD>
The number of files created on the volume.
</DD>
<DT>1-page B-trees</DT><DD>
The number of small B-trees on the volume.
</DD>
<DT>B-trees</DT><DD>
The number of full-sized B-trees on the volume.
</DD>
<DT>R-trees</DT><DD>
The number of full-sized R-trees on the volume.
</DD>
<DT>RD-trees</DT><DD>
The number of full-sized RD-trees on the volume.
</DD>
<DT>Pages per extent</DT><DD>
The size of an extent in pages (a compile-time constant).
</DD>
<DT>Extents in volume</DT><DD>
The number of extents in the formatted volume (determined
when the volume is formatted).
</DD>
<DT>vol hdr, bitmap ext</DT><DD>
The number of extents assigned for use as bit-map pages 
and the volume header.
</DD>
<DT>free extents</DT><DD>
The number of unallocated extents.
</DD>
<DT>allocated extents</DT><DD>
The number extents allocated for user data.
</DD>
</DL>
<HR>
<H1><A NAME="HRR.5">PAGE STATISTICS</A></H1>
<P>
A
<em>page</em>
is normally 8 kilobytes,
although a system can be 
rebuilt to use pages of a different size.
<P>
The statistics reported for pages are: 
<DL>
<DT>Total pages in volume</DT><DD>
The total number of pages in all the volume's extents.
Following this is a long list of the various kinds of pages
that have been allocated on the volume.
The kinds are as follows:
</DD>
<DT>small obj</DT><DD>
pages containing small objects  -- objects that are small
enough that they can fit in their entirety on one page, 
along with the various page headers and alignment taken
into account.
</DD>
<DT>large data</DT><DD>
pages containing the data of large objects 
</DD>
<DT>large data</DT><DD>
pages used for the data structure that links together
large data pages.
</DD>
<DT>xxxx lf pgs</DT><DD>
leaf pages of a tree of type xxxx.
</DD>
<DT>xxxx intern pgs</DT><DD>
internal pages of a tree of type xxxx.
</DD>
<DT>1pbtree</DT><DD>
one-page B-tree
</DD>
<DT>btree</DT><DD>
a B-tree created by an application program
</DD>
<DT>rtree, rdtree</DT><DD>
always zero
</DD>
<DT>store-dir</DT><DD>
a B-tree used by the SSM for maintenance of
volume data structures.
</DD>
<DT>root-idx</DT><DD>
a B-tree used by the SSM for maintenance of
volume data structures, and used by the Shore server
for 
locating the root directory, and for
storing information about persistent mounts.
</DD>
<DT>lid-map</DT><DD>
a B-tree used by the SSM to map logical OIDs to physical IDs.
</DD>
<DT>lidR-map</DT><DD>
a B-tree used by the SSM for a reverse mapping for remote IDs.
</DD>
<DT>used alloc pgs</DT><DD>
The total number of pages that have been allocated.
This number is the sum of preceding list of allocated pages
broken down by kind.
</DD>
<DT>unused alloc pgs</DT><DD>
The number of unused pages in allocated extents.
</DD>
<DT>Pages in alloc extents</DT><DD>
The total number of pages in extents that have been allocated. 
</DD>
<DT>Pages in unalloc exts </DT><DD>
The total number of pages in free extents. 
</DD>
<DT>Pages in hdr, bmap ext</DT><DD>
The number of pages in the extent allocated for the volume header
and for the free-space bit-map.
</DD>
</DL>
<HR>
<H1><A NAME="HRR.6">BYTE STATISTICS</A></H1>
<P>
The statistics reported in units of bytes might be daunting
at first, but they can be interpreted rather easily, with the
following information:
<P>
The intent is to give as much detail as possible about
where the bytes fall on every kind of page that a volume has:
<DL>
<DT>used</DT><DD>
any statistic so marked refers to bytes that are in use,
whether for an application's data, 
or for overhead of some sort, such as headers or alignment.
</DD>
<DT>unused, allocated</DT><DD>
bytes that are on allocated pages (pages in allocated extents)
but that are unused, either because the entire page is unused,
or because the bytes are unused (depending on the statistic).
Pages are assigned a purpose when their containing extent is allocated,
even though the entire page is not in use; thus, unused pages
can be designated &quot;unused small obj pages&quot;, etc.
</DD>
<DT>unallocated</DT><DD>
bytes in pages that are in unallocated extents.
<P>
</DD>
</DL>
Many statistics are reported as summary statistics, followed by
a report of more specific statistics, with percentages. 
The intent is to indicate the distribution of the items
being reported in detail, in terms of percentages of the
summary statistic.
For example, 
<BLOCKQUOTE><PRE>
In pages used                      :                          2400256
</PRE></BLOCKQUOTE>
is the summary, and
<BLOCKQUOTE><PRE>
In object pages                    :    2023424  (  84.300% of    2400256)
In SM indexes                      :     319488  (  13.311% of    2400256)
In user indexes                    :      32768  (   1.365% of    2400256)
</PRE></BLOCKQUOTE>
give more detail about the pages in use.
Furthermore, the &quot;object pages&quot; is reported in more and more detail:
<BLOCKQUOTE><PRE>
     user data in records          :    1627726  (  80.444% of    2023424)
         small object data         :    1194450  (  73.382% of    1627726)
         large object data         :     433276  (  26.618% of    1627726)

     record headers                :     122552  (   6.057% of    2023424)

     unused in allocated pages     :     159236  (   7.870% of    2023424)
         in small object pages     :     154032  (  96.732% of     159236)
         in large object leaf pgs  :       5204  (   3.268% of     159236)
         in large obj interior pgs :          0  (   0.000% of     159236)

     bytes lost in alignment       :       1694  (   0.084% of    2023424)
         for sysprops (headers)    :         16  (   0.945% of       1694)
         for user data             :       1678  (  99.055% of       1694)

     SM page headers               :      18556  (   0.917% of    2023424)
         for small obj pgs         :      14668  (  79.047% of      18556)
         for lg obj data pgs       :       3888  (  20.953% of      18556)

     other SM overhead             :      93660  (   4.629% of    2023424)
         for rec tags              :      73408  (  78.377% of      93660)
         for slots                 :      20212  (  21.580% of      93660)
             slots used            :      18352  (  90.798% of      20212)
             slots unused          :       1860  (   9.202% of      20212)
         for large object overhead :         40  (   0.043% of      93660)
             chunks                :         40  ( 100.000% of         40)
             indirect              :          0  (   0.000% of         40)
             index pg              :          0  (   0.000% of         40)
</PRE></BLOCKQUOTE>
<H2><A NAME="HRR.6.1">DEFINITIONS for BYTE STATISTICS</A></H2>
<DL>
<DT>record</DT><DD>
A record is the SSM portion of a small-object page
that contains a 
<em>Shore object.</em>
A record is further split into a
<em>record tag,</em>
<em>record header</em>
and a
<em>record body.</em>
The 
<em>record header</em>
contains the 
<em>system properties,</em>
or
<em>sysprops.</em>
</DD>
<DT>sysprops </DT><DD>
The  Shore
<em>system properties</em>
associated  with a Shore object, including
the owner, permission bits,  last-modified timestamp, 
etc.
</DD>
<DT>rec tag</DT><DD>
A tiny header attached to each record for SSM purposes.
</DD>
<DT>lost in alignment</DT><DD>
Each portion of a record is 8-byte aligned, so some
bytes are lost in alignment.
A Shore object containing 1 byte of application data,
for example, loses 7 bytes in alignment of the record body.
</DD>
<DT>object pages</DT><DD>
pages used for small objects and large objects.
</DD>
<DT>page headers</DT><DD>
Each page has a small header containing
information about the page and its status
for recovery purposes.
</DD>
<DT>slot</DT><DD>
Each small-object page contains a
<em>slot array</em>
that is used to locate the records on the page. 
</DD>
<DT>small obj</DT><DD>
pages containing small objects  -- objects that are small
enough that they can fit in their entirety on one page, 
along with the various page headers and alignment taken
into account.
</DD>
<DT>lg obj data</DT><DD>
pages containing the data of large objects 
</DD>
<DT>interior</DT><DD>
pages used for the data structures (trees) links together
other pages, whether for B-trees or for large objects

</DD>
</DL>
<HR>
<H1><A NAME="HRR.7">SUMMARY STATISTICS</A></H1>
<P>
The summary statistics report selected
information that is reported in each
of other categories.
<HR>
<H1><A NAME="HRR.8">BUGS</A></H1>
<P>
 <strong>Df</strong>
leaves you sitting in the directory that is the root
of the last volume for which it computed the statistics.
<HR>
<H1><A NAME="HRR.9">VERSION</A></H1>
This manual page applies to Version 1.1.1 of the Shore software.
<HR>
<H1><A NAME="HRR.10">SPONSORSHIP</A></H1>
The Shore project is sponsored by the Advanced Research Project Agency, ARPA
order number 018 (formerly 8230), monitored by the U.S. Army Research
Laboratory under contract DAAB07-91-C-Q518.
<HR>
<H1><A NAME="HRR.11">COPYRIGHT</A></H1>
Copyright &#169; 1994, 1995, 1996, 1997,
Computer Sciences Department, University of
Wisconsin -- Madison. All Rights Reserved.
<HR>
<H1><A NAME="HRR.12">SEE ALSO</A></H1>
<A HREF="shell.svas.html"><STRONG>shell(svas)</STRONG></A>
</BODY>
</HTML>
