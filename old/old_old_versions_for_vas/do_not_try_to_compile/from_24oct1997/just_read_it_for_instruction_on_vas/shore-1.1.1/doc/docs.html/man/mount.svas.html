<!-- Warning: Do not edit this file. -->
<!-- It was created automatically by yam2html.pl 1.3  -->
<!-- on Mon Oct 27 09:41:02 CST 1997 from file mansvas/mount.svas -->
<!DOCTYPE HTML public "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>
mount(svas) -- Shore Reference Manual
</TITLE>
<LINK REV="made" HREF="mailto:solomon@cs.wisc.edu">
</HEAD>

<BODY>

<!-- .so tmac.man.local -->
<H1><A NAME="HRR.0">
mount - Shore file systems and volumes
</A></H1><HR>
<H1>
CONTENTS
</H1>
<UL>
<LI>
<A HREF="#HRR.1">SYNOPSIS</A>
</LI>
<LI>
<A HREF="#HRR.2">DESCRIPTION</A>
<UL>
<LI>
<A HREF="#HRR.2.1">format, serve, unserve: Making devices usable</A>
</LI>
<LI>
<A HREF="#HRR.2.2">mkfs, rmfs: Making file systems</A>
</LI>
<LI>
<A HREF="#HRR.2.3">getroot, setroot: Establishing a root volume</A>
</LI>
<LI>
<A HREF="#HRR.2.4">mount, pmount, dismount: Establishing a root volume</A>
</LI>
<LI>
<A HREF="#HRR.2.5">patch: fixing broken cross-volume links</A>
</LI>
</UL>
</LI>
<LI>
<A HREF="#HRR.3">VERSION</A>
</LI>
<LI>
<A HREF="#HRR.4">SPONSORSHIP</A>
</LI>
<LI>
<A HREF="#HRR.5">COPYRIGHT</A>
</LI>
<LI>
<A HREF="#HRR.6">SEE ALSO</A>
</LI></UL><HR>
<H1><A NAME="HRR.1">SYNOPSIS</A></H1>
<BLOCKQUOTE><PRE>
format &lt;device&gt; &lt;kb&gt; &lt;force&gt;
serve &lt;device&gt; 
unserve &lt;device&gt; 
newvid 
mkfs &lt;device&gt; &lt;kb&gt; &lt;lvid&gt;
rmfs &lt;lvid&gt;
getroot 
setroot &lt;lvid&gt;
mount
pmount &lt;lvid&gt; &lt;mountpoint&gt; 
dismount &lt;mountpoint&gt; 
patch &lt;mountpoint | lvid&gt;
</PRE></BLOCKQUOTE>
<HR>
<H1><A NAME="HRR.2">DESCRIPTION</A></H1>
<P>
These commands are understood by the
Shore server's terminal interface, when
the server is run in the foreground.
The terminal interface is intended only for
doing administrative functions.
<em>It is NOT intended for normal work.</em>
(Think of it as a machine console with
blocking I/O.)
<P>
The Shore name space is a 
global name space and a Unix file system tree.
A server can &quot;plug&quot; into the name space
in selected places by choosing a node of the
tree as its root.
The server can then see everything that
descends from that root.
<P>
A Shore file system is the unit of 
distribution of objects across 
devices and servers.
A Shore file system is implemented
as a Shore Storage Manager volume,
and so a file system is identified by its
volume ID.
<P>
Each file system is a hierarchy, containing
a portion of the name space, and a single root
node.
At its leaves, a Shore file system can contain
links to the roots of other Shore file systems,
which can be served by the same server or by
remote servers.
<P>
<H2><A NAME="HRR.2.1">format, serve, unserve: Making devices usable</A></H2>
<P>
Use the command
<BLOCKQUOTE><PRE>
format &lt;device&gt; &lt;kb&gt; [&lt;force&gt;]
</PRE></BLOCKQUOTE>
to make the server prepare a
device (a Unix file or a raw device)
for use.
Data that reside on the device are destroyed
by this command.
The second argument indicates the intended
size of the device in kilobytes.
<P>
Use the command
<BLOCKQUOTE><PRE>
serve &lt;device&gt; 
</PRE></BLOCKQUOTE>
to inform a server that it is the one responsible
for all access to the named device.
The device is identified by a Unix path. 
The command
 <strong>unserve</strong>reverses<strong>the</strong>process.
A device must be served before volumes and file
systems can be made on it.
<H2><A NAME="HRR.2.2">mkfs, rmfs: Making file systems</A></H2>
<P>
To make a Shore file system on a device, do
<BLOCKQUOTE><PRE>
mkfs &lt;device&gt; &lt;kb&gt; &lt;lvid&gt;
</PRE></BLOCKQUOTE>
The second argument is the number of kilobytes
to give the volume for a quota, and the 
last argument is a volume identifier to assign
to the resulting volume.
You can choose you volume identifiers yourself,
or you can use
 <strong>newvid</strong>
to generate unique volume identifiers for you.
 <strong>Rmfs</strong>destroys<strong>the</strong>file<strong>system</strong>without<strong>reformatting</strong>
the volume.
<H2><A NAME="HRR.2.3">getroot, setroot: Establishing a root volume</A></H2>
<P>
When you start a server, it expects to be given
a volume ID for the root of its file system.
If no root is given, you can format devices,
serve and unserve, and and make file systems,
but you cannot use them in any way until you 
establish the root volume.
<BLOCKQUOTE><PRE>
setroot &lt;lvid&gt;
</PRE></BLOCKQUOTE>
establishes the root node on the given volume
as the directory that corresponds to &quot;/&quot;
in all file system activity that ensues.
<BLOCKQUOTE><PRE>
getroot 
</PRE></BLOCKQUOTE>
returns the root if it has been set.
<P>
If your devices have already been formatted,
and your file systems already made, you can
start your server and run it in the background,
by using the configuration/command-line option
<em>svas_root</em>
to establish the root volume.
<H2><A NAME="HRR.2.4">mount, pmount, dismount: Establishing a root volume</A></H2>
<P>
The command
<BLOCKQUOTE><PRE>
mount
</PRE></BLOCKQUOTE>
simply prints the mount table (the table of
file systems about which the server
has information).
Each time the file system is expanded by linking
volumes together (below), the Shore server
stores meta data about the link
in an index at the root of the volume.
This permits you to find all the persistent
links without scanning the entire file system.
The 
 <strong>mount</strong>
command gathers it information from these indexes.
It indicates, with a
<strong>T</strong>
the root volume,
and with a
<strong>P</strong>
those volumes that are the targets of
persistent, cross-file system links.
<P>
To gain access to a file system other than
your root file system, you can create links
to other (already-formatted and served)
volumes with:
<BLOCKQUOTE><PRE>
pmount &lt;lvid&gt; &lt;mountpoint&gt;
</PRE></BLOCKQUOTE>
The volume identifier indicates a volume already
served by some Shore server.
The mount point is a path in the 
name space visible to this server.
The directory indicated by the path must exist,
and be writable, and the last component of the
path cannot name an object that exists.
This command is similar to the Unix
<em>ln</em>
command; it makes a (hard) link to the root directory
of the given volume.
You must also have write permission for the root
directory of the volume identified by &lt;lvid&gt;,
because its entry &quot;..&quot; is changed.
<BLOCKQUOTE><PRE>
dismount &lt;mountpoint&gt;
</PRE></BLOCKQUOTE>
does the reverse of 
 <strong>pmount.</strong>
The directories at both ends of the link must be
writable.
<H2><A NAME="HRR.2.5">patch: fixing broken cross-volume links</A></H2>
<P>
It is possible for cross-volume (cross-file system) links
to be corrupted, for example, when
one of two devices is destroyed while the server
is down.
In some cases it is necessary to patch the links.
This command lets you effectively undo these
cross-file system links without considering
corrupted states to be error states.
It also cleans up the metadata that are
stored on each volume to keep track of these
persistent links.
<HR>
<H1><A NAME="HRR.3">VERSION</A></H1>
This manual page applies to Version 1.1.1 of the Shore software.
<HR>
<H1><A NAME="HRR.4">SPONSORSHIP</A></H1>
The Shore project is sponsored by the Advanced Research Project Agency, ARPA
order number 018 (formerly 8230), monitored by the U.S. Army Research
Laboratory under contract DAAB07-91-C-Q518.
<HR>
<H1><A NAME="HRR.5">COPYRIGHT</A></H1>
Copyright &#169; 1994, 1995, 1996, 1997,
Computer Sciences Department, University of
Wisconsin -- Madison. All Rights Reserved.
<HR>
<H1><A NAME="HRR.6">SEE ALSO</A></H1>
</BODY>
</HTML>
