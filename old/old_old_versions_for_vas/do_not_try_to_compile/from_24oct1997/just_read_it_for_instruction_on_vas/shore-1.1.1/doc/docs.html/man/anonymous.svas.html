<!-- Warning: Do not edit this file. -->
<!-- It was created automatically by yam2html.pl 1.3  -->
<!-- on Mon Oct 27 09:40:58 CST 1997 from file mansvas/anonymous.svas -->
<!DOCTYPE HTML public "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>
anonymous(svas) -- Shore Reference Manual
</TITLE>
<LINK REV="made" HREF="mailto:solomon@cs.wisc.edu">
</HEAD>

<BODY>

<!-- .so tmac.man.local -->
<H1><A NAME="HRR.0">
anonymous - creating and destroying anonymous Shore objects
</A></H1><HR>
<H1>
CONTENTS
</H1>
<UL>
<LI>
<A HREF="#HRR.1">SYNOPSIS</A>
</LI>
<LI>
<A HREF="#HRR.2">DESCRIPTION</A>
</LI>
<LI>
<A HREF="#HRR.3">ARGUMENTS</A>
</LI>
<LI>
<A HREF="#HRR.4">ERRORS</A>
</LI>
<LI>
<A HREF="#HRR.5">ENVIRONMENT</A>
</LI>
<LI>
<A HREF="#HRR.6">VERSION</A>
</LI>
<LI>
<A HREF="#HRR.7">SPONSORSHIP</A>
</LI>
<LI>
<A HREF="#HRR.8">COPYRIGHT</A>
</LI>
<LI>
<A HREF="#HRR.9">SEE ALSO</A>
</LI></UL><HR>
<H1><A NAME="HRR.1">SYNOPSIS</A></H1>
<BLOCKQUOTE><PRE>

// create anonymous objects with initialized contents

VASResult       
shore_vas::mkAnonymous(
    const lrid_t        &amp;pool,   // oid of pool object
    const lrid_t        &amp;typeobj,// object's type
    const vec_t         &amp;core,   // data for core
    const vec_t         &amp;heap,   // data for heap
    ObjectOffset        tstart,  // where text starts
    int                 nindexes, // # indexes
    lrid_t              *resultref,
    void                *physid=0 
);

VASResult       
shore_vas::mkAnonymous(
    const lrid_t        &amp;pool,   // oid of pool object
    const lrid_t        &amp;typeobj,// object's type
    const vec_t         &amp;core,   // data for core
    const vec_t         &amp;heap,   // data for heap
    ObjectOffset        tstart,  // where text starts
    int                 nindexes, // # indexes
    const lrid_t        ref      // preallocated serial#
);

// create anonymous objects with uninitialized contents

VASResult       
shore_vas::mkAnonymous(
    const lrid_t        &amp;pool,   // oid of pool object
    const lrid_t        &amp;typeobj,// object's type
    ObjectSize          csize,   // size of core 
    ObjectSize          hsize,   // size of heap
    ObjectOffset        tstart,  // where text starts
    int                 nindexes, // # indexes
    lrid_t              *resultref
);

VASResult       
shore_vas::mkAnonymous(
    const lrid_t        &amp;pool,   // oid of pool object
    const lrid_t        &amp;typeobj,// object's type
    ObjectSize          csize,   // sizeo of core
    ObjectSize          hsize,   // sizeo of heap
    ObjectOffset        tstart,  // where text starts
    int                 nindexes, // # indexes
    const lrid_t        ref      // preallocated serial#
);

VASResult       shore_vas::rmAnonymous(
    const lrid_t        &amp;obj
);
</PRE></BLOCKQUOTE>
<HR>
<H1><A NAME="HRR.2">DESCRIPTION</A></H1>
These methods create and destroy anonymous objects,
which are objects that reside in a 
<A HREF="pool.svas.html">pool.</A>
The caller is responsible for maintaining the integrity
of the objects' types, which means that the caller must
update the inverses of bidirectional relationships
and indexes
in which the object in question participates.
<P>
These methods 
<em>cannot</em>
be used to create indexes.
<HR>
<H1><A NAME="HRR.3">ARGUMENTS</A></H1>
When an anonymous object is created,
its location (pool) must be identified by an object identifier.
<P>
The argument
 <em>typeobj</em>
must refer to a type in a frozen 
<A HREF="../sdlman/sdlman.html">module.</A>
<P>
The first and second forms of the method
 <strong>mkAnonymous</strong>
create objects with initialized data; the third and fourth
forms create objects with uninitialized data.
When initialized data are given
(arguments
 <em>core</em>
and
 <em>vec</em>
), the 
vectors may be of any size; they may also be empty.
Once an object is created, its core size cannot change.
<P>
The first and third forms of the method
 <strong>mkAnonymous</strong>
create objects without requiring
a pre-allocated serial number.
When these methods are used, the server allocates and
returns a serial number.
The argument
 <em>resultref</em>
is used both for passing information in and
out of the methods.
On input, the value of
 <em>*resultref</em>
is inspected; if its serial number is null (in the sense that
<BLOCKQUOTE><PRE>
(*resultref) == serial_t::null
</PRE></BLOCKQUOTE>
-- see 
<A HREF="oid.shore.html">oid(shore)</A>
),
the Shore Value-Added Server 
allocates a new identifier for the object to be created.
If the serial number is not null,  the value
 <em>*resultref</em>
is considered to be a pre-allocated, unused object identifier,
and it is given to the object to be created.
In both cases,
the logical object identifier for the object created
is returned in 
 <em>*resultref.</em>
<P>
The second and fourth forms of the method
 <strong>mkAnonymous</strong>
create objects with a pre-allocated serial number,
 <em>ref.</em>
<P>
 <em>Tstart</em>
specifies the first byte (from the beginning of the object)
of the TEXT attribute. 
If the object has no TEXT attribute, the value of 
 <em>tstart</em>
must be
<strong>NoText.</strong>
(This is not checked by the Value-Added Server.
It is the responsibility of the caller to see that
this is the case.)
<P>
The argument
 <em>nindexes</em>
is the number of manual indexes that the object
will have when the type system has finished creating the
object.
The SVAS keeps track of the indexes so that it can 
destroy them when the object is destroyed. 
This value cannot be changed after the object is created.
<P>
In the first form of
 <strong>mkAnonymous,</strong>
the argument
 <em>physid</em>
is optional, and if present, it points to a place in the
caller's addresss space into which the SVAS will
place the physical object identifier of the 
object that was created.
This is for use by other Value-Added Servers that
store physical object identifiers for performance reasons,
and it is implemented only in the server libary; client
processes may not use this feature.
<HR>
<H1><A NAME="HRR.4">ERRORS</A></H1>
If the caller provides a pre-allocated object identifier to 
 <strong>mkAnonymous,</strong>
the burden is on the caller to see that the object identifier
is legitimate and is not already in use.
The best way to do that is to allocate the object identifier and
create the object in the same transaction.
<P>
The SVAS does require that the object identifier given be
on the same volume as the pool in which the object is to be created.
If it is not, method returns in failure, with the error status
<strong>ST_VolumesDontMatch.</strong>
<P>
Deadlocks can occur while locks are being acquired.  See
<A HREF="transaction.svas.html"><STRONG>transaction(svas)</STRONG></A> 
for information about deadlocks.
<P>
A complete list of errors is in
<A HREF="errors.svas.html">errors(svas).</A>
<HR>
<H1><A NAME="HRR.5">ENVIRONMENT</A></H1>
All these methods are available on the client side and the
server side.
The argument
 <em>physid</em>
may not be used by a client.
<HR>
<H1><A NAME="HRR.6">VERSION</A></H1>
This manual page applies to Version 1.1.1 of the Shore software.
<HR>
<H1><A NAME="HRR.7">SPONSORSHIP</A></H1>
The Shore project is sponsored by the Advanced Research Project Agency, ARPA
order number 018 (formerly 8230), monitored by the U.S. Army Research
Laboratory under contract DAAB07-91-C-Q518.
<HR>
<H1><A NAME="HRR.8">COPYRIGHT</A></H1>
Copyright &#169; 1994, 1995, 1996, 1997,
Computer Sciences Department, University of
Wisconsin -- Madison. All Rights Reserved.
<HR>
<H1><A NAME="HRR.9">SEE ALSO</A></H1>
<A HREF="pool.svas.html"><STRONG>pool(svas)</STRONG></A>,
<A HREF="manualindex.svas.html"><STRONG>manualindex(svas)</STRONG></A>,
<A HREF="indexscan.svas.html"><STRONG>indexscan(svas)</STRONG></A>,
<A HREF="oid.shore.html"><STRONG>oid(shore)</STRONG></A>,
<A HREF="errors.svas.html"><STRONG>errors(svas)</STRONG></A>
and
<A HREF="text.svas.html"><STRONG>text(svas)</STRONG></A>.
</BODY>
</HTML>
