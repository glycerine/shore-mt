<!-- Warning: Do not edit this file. -->
<!-- It was created automatically by yam2html.pl 1.3  -->
<!-- on Mon Oct 27 09:40:59 CST 1997 from file mansvas/directory.svas -->
<!DOCTYPE HTML public "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>
directory(svas) -- Shore Reference Manual
</TITLE>
<LINK REV="made" HREF="mailto:solomon@cs.wisc.edu">
</HEAD>

<BODY>

<!-- .so tmac.man.local -->
<H1><A NAME="HRR.0">
mkDir, rmDir, getRootDir, chDir, cwd, gwd - using Shore directories
</A></H1><HR>
<H1>
CONTENTS
</H1>
<UL>
<LI>
<A HREF="#HRR.1">SYNOPSIS</A>
</LI>
<LI>
<A HREF="#HRR.2">DESCRIPTION</A>
</LI>
<LI>
<A HREF="#HRR.3">ARGUMENTS</A>
</LI>
<LI>
<A HREF="#HRR.4">ENVIRONMENT</A>
</LI>
<LI>
<A HREF="#HRR.5">ERRORS</A>
</LI>
<LI>
<A HREF="#HRR.6">VERSION</A>
</LI>
<LI>
<A HREF="#HRR.7">SPONSORSHIP</A>
</LI>
<LI>
<A HREF="#HRR.8">COPYRIGHT</A>
</LI>
<LI>
<A HREF="#HRR.9">SEE ALSO</A>
</LI></UL><HR>
<H1><A NAME="HRR.1">SYNOPSIS</A></H1>
<BLOCKQUOTE><PRE>
VASResult       shore_vas::mkDir(
    const Path          path, 
    mode_t              mode,
    lrid_t              *result  
);

VASResult       shore_vas::rmDir(
    const Path          path
);

enum sm_lock_mode_t { NL = 0, IS, IX, SH, SIX, UD, EX };
typedef sm_lock_mode_t    LockMode;


VASResult shore_vas::chDir(
    const Path          path, 
    LockMode            optional = NL
);

lrid_t   shore_vas::cwd()   const;

char     *shore_vas::gwd(
    char                *result,
    int                 resultlen,
    lrid_t              *dir = 0
);

VASResult shore_vas::getRootDir(
    lrid_t              *dir
);

</PRE></BLOCKQUOTE>
<HR>
<H1><A NAME="HRR.2">DESCRIPTION</A></H1>
The  methods 
 <strong>mkDir</strong>
and
 <strong>rmDir</strong>
create and destroy Shore directory objects.
<P>
The method
 <strong>chDir</strong>
changes the current working directory for SVAS instance.
It acquires share locks on each directory in the given path.
The caller may specify a lock to be acquired on the final
directory in the path, if a lock stronger than a share lock is
desired.
<P>
 <strong>Cwd</strong>
returns the OID of the 
current working directory.
 <strong>Gwd</strong>
returns the path of the current working directory,
or of the directory given.
 <strong>Gwd</strong>computes<strong>the</strong>path<strong>by</strong>
successively changing directories to &quot;..&quot;
from the initial working directory to the root,
and by reading the directories along the way.
<P>
All these methods except 
 <strong>cwd</strong>
acquire locks and manipulate objects,
so they must be run in transactions.
<P>
 <strong>GetRootDir</strong>
returns the oid of the root directory for the server.
<P>
<HR>
<H1><A NAME="HRR.3">ARGUMENTS</A></H1>
 <em>Path</em>
identifies the object of interest.
It can be a full pathname, a relative pathname, or 
simply the file name. 
If it is a file name, the current working directory is assumed
to be the directory in which the object is to reside (or already resides,
in the case of removal).
<P>
 <em>Mode</em>
is the permissions bits for the object.
When a directory is created, the given mode is modified
by the client process's 
<A HREF="umask.svas.html">umask.</A>
<P>
The 
 <em>result</em>
must point to an area in the caller's address space
into which the SVAS writes the OID of the
resulting directory object.
It may not be a null pointer.
<P>
 <strong>ChDir</strong>
will obtain a lock on the final component
of the path if a lock mode is given for the
argument
 <em>optional.</em>
If 
 <em>optional</em>
is not given,
a share lock is acquired.
<P>
 <strong>Gwd</strong>
takes a pointer to a buffer in the 
caller's address space (
 <em>result</em>
) and a length,
 <em>resultlen,</em>
and writes the
pathname of the current working directory 
into the buffer.
A null character (ASCII NUL) terminates the
pathname.
The SVAS returns an error if the pathname and its
terminating NUL do not fit in the buffer given.
If the caller provides a non-null pointer to the 
object identifier of a directory  in
 <em>dir,</em>
 <strong>gwd</strong>
calculates
a pathname of the given directory instead
of the current working directory.
<P>

<HR>
<H1><A NAME="HRR.4">ENVIRONMENT</A></H1>
 <strong>MkDir,</strong>
 <strong>rmDir</strong>
and
 <strong>chDir</strong>
are available to both client and
server processes.
 <strong>Cwd,</strong>
and
 <strong>gwd</strong>
are on the server and in the client library.
<HR>
<H1><A NAME="HRR.5">ERRORS</A></H1>
<P>
Deadlocks can occur while locks are being acquired.  See
<A HREF="transaction.svas.html"><STRONG>transaction(svas)</STRONG></A> 
for information about deadlocks.
<P>
A complete list of errors is in
<A HREF="errors.svas.html"><STRONG>errors(svas)</STRONG></A>.
<HR>
<H1><A NAME="HRR.6">VERSION</A></H1>
This manual page applies to Version 1.1.1 of the Shore software.
<HR>
<H1><A NAME="HRR.7">SPONSORSHIP</A></H1>
The Shore project is sponsored by the Advanced Research Project Agency, ARPA
order number 018 (formerly 8230), monitored by the U.S. Army Research
Laboratory under contract DAAB07-91-C-Q518.
<HR>
<H1><A NAME="HRR.8">COPYRIGHT</A></H1>
Copyright &#169; 1994, 1995, 1996, 1997,
Computer Sciences Department, University of
Wisconsin -- Madison. All Rights Reserved.
<HR>
<H1><A NAME="HRR.9">SEE ALSO</A></H1>
<A HREF="getdirentries.svas.html"><STRONG>getdirentries(svas)</STRONG></A>,
<A HREF="mount.svas.html"><STRONG>mount(svas)</STRONG></A>,
<A HREF="lookup.svas.html"><STRONG>lookup(svas)</STRONG></A>,
<A HREF="errors.svas.html"><STRONG>errors(svas)</STRONG></A>,
<A HREF="transaction.svas.html"><STRONG>transaction(svas)</STRONG></A>,
<A HREF="lockObj.svas.html"><STRONG>lockObj(svas)</STRONG></A>,
<A HREF="svas_server.svas.html"><STRONG>svas_server(svas)</STRONG></A>,
and
<A HREF="text.svas.html"><STRONG>text(svas)</STRONG></A>.
</BODY>
</HTML>
