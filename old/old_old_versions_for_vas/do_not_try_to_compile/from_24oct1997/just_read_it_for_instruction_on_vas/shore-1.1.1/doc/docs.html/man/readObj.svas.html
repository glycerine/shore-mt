<!-- Warning: Do not edit this file. -->
<!-- It was created automatically by yam2html.pl 1.3  -->
<!-- on Mon Oct 27 09:41:03 CST 1997 from file mansvas/readObj.svas -->
<!DOCTYPE HTML public "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>
readobj(svas) -- Shore Reference Manual
</TITLE>
<LINK REV="made" HREF="mailto:solomon@cs.wisc.edu">
</HEAD>

<BODY>

<!-- .so tmac.man.local -->
<H1><A NAME="HRR.0">
readObj - inspect a Shore object
</A></H1><HR>
<H1>
CONTENTS
</H1>
<UL>
<LI>
<A HREF="#HRR.1">SYNOPSIS</A>
</LI>
<LI>
<A HREF="#HRR.2">DESCRIPTION</A>
</LI>
<LI>
<A HREF="#HRR.3">ARGUMENTS</A>
</LI>
<LI>
<A HREF="#HRR.4">ENVIRONMENT</A>
</LI>
<LI>
<A HREF="#HRR.5">ERRORS</A>
</LI>
<LI>
<A HREF="#HRR.6">VERSION</A>
</LI>
<LI>
<A HREF="#HRR.7">SPONSORSHIP</A>
</LI>
<LI>
<A HREF="#HRR.8">COPYRIGHT</A>
</LI>
<LI>
<A HREF="#HRR.9">SEE ALSO</A>
</LI></UL><HR>
<H1><A NAME="HRR.1">SYNOPSIS</A></H1>
<BLOCKQUOTE><PRE>
VASResult shore_vas::readObj(
            const  lrid_t     &amp;obj,     
            ObjectOffset      offset,     
            ObjectSize        nbytes,     
            LockMode          lock,     
            const  vec_t      &amp;data,     
            ObjectSize        *used,     
            ObjectSize        *more,   
            lrid_t            *snapped=NULL,
            bool              *page_cached=NULL
        );    
         
</PRE></BLOCKQUOTE>
<HR>
<H1><A NAME="HRR.2">DESCRIPTION</A></H1>
 <strong>ReadObj</strong>
reads all or part of an object into the caller's
address space.
<HR>
<H1><A NAME="HRR.3">ARGUMENTS</A></H1>
The argument
 <em>obj</em>
is the full logical object identifier of the object to be read.
<P>
The argument
 <em>offset</em>
indicates the first byte of the object to be read.
<P>
The argument
 <em>nbytes</em>
indicates the number of bytes to be read.
It can take the value 
<A HREF="text.svas.html">WholeObject,</A>
in which case, the SVAS will read as much of the object
into the given buffer.
 <em>Data</em>
is a buffer in which to copy the contents of the object.
If the buffer is too small for the requested data (client side and 
server side), 
or if the object is fragmented over several disk blocks (server side only), 
the the SVAS 
copies what it can into the buffer and 
updates the value to which the result argument
 <em>more</em>
points, to reflect the number of bytes that did not get
copied into the buffer.
 <em>Used</em>
is an output argument that indicates the number of bytes of the
buffer that were written by 
 <strong>readObj.</strong>
<P>
The argument
 <em>snapped</em>
is an (optional) output argument into which 
the SVAS writes the snapped logical record ID of the object.
<P>
The argument 
 <em>lock</em>
takes one of the values
<BLOCKQUOTE><PRE>
    enum LockMode { NL=0,IS=1,IX=2,S=3,SIX=4,U=5,X=6 },
</PRE></BLOCKQUOTE>
which indicates what kind of a lock the SVAS will acquire
when the object is read.
A value below S is ignored; a share lock (S) is the minimum
lock acquired.
The call to 
 <strong>readObj</strong>
blocks until the lock is acquired or until a deadlock occurs.
<P>
The argument
 <em>page_cached</em>
is an (optional) output argument into which 
the SVAS writes 
 <em>true</em>
if the read resulted in a page of small (anonymous) objects being
cached.
See
<A HREF="page.svas.html"><STRONG>page(svas)</STRONG></A>
for information about how to use the page of cached objects.
<HR>
<H1><A NAME="HRR.4">ENVIRONMENT</A></H1>
 <strong>ReadObj</strong>
is available
on both the server and clients.
On the client side,
if the object being read is a
 <em>small, anonymous object</em>,
the entire page of small objects is
copied to the client's address space, because
all the objects on the page are anonymous
objects in the same pool, and therefore have the
same permissions.
A share lock (S) is acquired on the page.
<P>
If a full page of objects is copied to the client's
address space, the page is put into shared memory
or is sent over a network connection,
depending on the second argument used when the
value-added server is constructed with
 <strong>new_svas().</strong>
(The second argument determines the number of bytes
of shared memory allocated for such a purpose.)
<P>
If a large object is read, pages of the object's data
are shipped to the client in the same manner, depending
on the third argument given to 
 <strong>new_svas().</strong>
(The third argument determines the number bytes of shared
memory allocated for  the purpose of transferring large objects.)
<P>
 <strong>ReadObj</strong>
must be called when a transaction is active.
<HR>
<H1><A NAME="HRR.5">ERRORS</A></H1>
The return values are valid only if 
 <strong>readObj</strong>
returns ST_OK.
<P>
Deadlocks can occur while locks are being acquired.  See
<A HREF="transaction.svas.html"><STRONG>transaction(svas)</STRONG></A> 
for information about deadlocks.
<P>
A complete list of errors is in
<A HREF="errors.svas.html"><STRONG>errors(svas)</STRONG></A>.
<HR>
<H1><A NAME="HRR.6">VERSION</A></H1>
This manual page applies to Version 1.1.1 of the Shore software.
<HR>
<H1><A NAME="HRR.7">SPONSORSHIP</A></H1>
The Shore project is sponsored by the Advanced Research Project Agency, ARPA
order number 018 (formerly 8230), monitored by the U.S. Army Research
Laboratory under contract DAAB07-91-C-Q518.
<HR>
<H1><A NAME="HRR.8">COPYRIGHT</A></H1>
Copyright &#169; 1994, 1995, 1996, 1997,
Computer Sciences Department, University of
Wisconsin -- Madison. All Rights Reserved.
<HR>
<H1><A NAME="HRR.9">SEE ALSO</A></H1>
<A HREF="sysprops.svas.html"><STRONG>sysprops(svas)</STRONG></A>,
<A HREF="writeObj.svas.html"><STRONG>writeObj(svas)</STRONG></A>,
<A HREF="truncObj.svas.html"><STRONG>truncObj(svas)</STRONG></A>,
<A HREF="appendObj.svas.html"><STRONG>appendObj(svas)</STRONG></A>,
<A HREF="lockObj.svas.html"><STRONG>lockObj(svas)</STRONG></A>,
<A HREF="errors.svas.html"><STRONG>errors(svas)</STRONG></A>,
<A HREF="new_svas.svas.html"><STRONG>new_svas(svas)</STRONG></A>,
and
<A HREF="transaction.svas.html"><STRONG>transaction(svas)</STRONG></A>.
</BODY>
</HTML>
