<!-- Warning: Do not edit this file. -->
<!-- It was created automatically by yam2html.pl 1.3  -->
<!-- on Mon Oct 27 09:41:02 CST 1997 from file mansvas/permissions.svas -->
<!DOCTYPE HTML public "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>
permissions(svas) -- Shore Reference Manual
</TITLE>
<LINK REV="made" HREF="mailto:solomon@cs.wisc.edu">
</HEAD>

<BODY>

<!-- .so tmac.man.local -->
<H1><A NAME="HRR.0">
chGrp, chMod, chOwn -  changing permissions of Shore objects
</A></H1><HR>
<H1>
CONTENTS
</H1>
<UL>
<LI>
<A HREF="#HRR.1">SYNOPSIS</A>
</LI>
<LI>
<A HREF="#HRR.2">DESCRIPTION</A>
</LI>
<LI>
<A HREF="#HRR.3">ARGUMENTS</A>
</LI>
<LI>
<A HREF="#HRR.4">ERRORS</A>
</LI>
<LI>
<A HREF="#HRR.5">ENVIRONMENT</A>
</LI>
<LI>
<A HREF="#HRR.6">VERSION</A>
</LI>
<LI>
<A HREF="#HRR.7">SPONSORSHIP</A>
</LI>
<LI>
<A HREF="#HRR.8">COPYRIGHT</A>
</LI>
<LI>
<A HREF="#HRR.9">SEE ALSO</A>
</LI></UL><HR>
<H1><A NAME="HRR.1">SYNOPSIS</A></H1>
<BLOCKQUOTE><PRE>
(TODO: make sure all these assertions are enforced by the code!)

class Permissions {
	// from svas/include/permissions.h:
	enum {
        SetUid  =04000, SetGid  =02000, Sticky  =01000, 
        Rown    =00400, Wown    =00200, Xown    =00100,
        Rgrp    =00040, Wgrp    =00020, Xgrp    =00010,
        Rpub    =00004, Wpub    =00002, Xpub    =00001
	};
	...
};

VASResult       shore_vas::chGrp(
	const 	Path	file,
	gid_t			gid
);

VASResult       shore_vas::chMod(
	const 	Path	file,
	mode_t			mode
);

VASResult       shore_vas::chOwn(
	const 	Path	file,
	uid_t			uid
);
</PRE></BLOCKQUOTE>
<HR>
<H1><A NAME="HRR.2">DESCRIPTION</A></H1>
Each Shore object has an owner, group, and permission bits,
analogous to Unix owner, group and permission bits.
Only registered objects have their own permissions; anonymous
objects inherit the permissions of their pools.
<P>
When a registered object is created, its default permissions are
determined as follows:
<DL>
<DT>group</DT><DD>
if the 
<strong>Permissions::SetGid</strong>
of the parent directory is clear,
the object's group is
the effective group ID of the client process,
otherwise it is the 
the effective group ID of the directory in which the object is created
(BSD file-creation semantics are not supported)
</DD>
<DT>owner</DT><DD>
the effective user ID of the client process that creates the object
</DD>
<DT>mode</DT><DD>
the mode given as an argument to the create method, modified
bye the client process's 
<A HREF="umask.svas.html">umask.</A>
<P>
</DD>
</DL>
Each of the above methods
takes a pathname for an object to change.
If the object identified by 
 <em>path</em>
is a symbolic link or a cross-reference, 
the properties of the symbolic link are changed, 
not the properties of the object to which it refers.
<P>
Only the super-user may change the owner of an object.
The owner of an object may change the object's group to
a group of which he is a member.
<P>
The super-user may change an object's group to any group.
<P>
The effective user ID of the client process must
match the owner of the file (or it must be super-user)
in order to change the mode of the file.
<P>
If the effective user ID of the client process is not super-user
and the process successfully changes the group of an object,
the object's
<strong>Permissions::SetUid</strong>
and 
<strong>Permissions::SetGid</strong>
bits are cleared.
<P>
If the effective user ID of the client process is not super-user
and the process attempts to change the object's
<strong>Permissions::SetGid</strong>
bit,
and the object's group is 
not in the process's supplementary groups,
the 
<strong>Permissions::SetGid</strong>
bit is cleared.
<P>
If a user other than the super-user updates an object, the
<strong>Permissions::SetUid</strong>
and
<strong>Permissions::SetGid</strong>
bits are cleared.
<HR>
<H1><A NAME="HRR.3">ARGUMENTS</A></H1>
The group ID is presumed to be a value taken from the Unix group database.
<P>
The user ID is presumed to be a value taken from the Unix password database.
<P>
The bits of a 
<em>mode_t</em>
value have the following meanings:
<DL>
<DT>SetUid</DT><DD>
Set user ID on execution: 
the client process's effective user ID is set to that of the owner
of the file when the file is executed.
For registered objects, this bit is cleared when the object is
written.
</DD>
<DT>SetGid</DT><DD>
Set group ID on execution: 
the client process's effective group ID is set to that of the owner
of the file when the file is executed.
For registered objects, this bit is cleared when the object is
written.
</DD>
<DT>Sticky</DT><DD>
If this bit is set on a directory object, an
unprivileged user (the client process's user ID is not super-user) 
may not delete or rename objects in that directory
unless the objects are owned by the user. 
</DD>
<DT>Rown</DT><DD>
Read permission bit for the owner of the file or directory.
</DD>
<DT>Wown</DT><DD>
Write permission bit for the owner of the file or directory.
</DD>
<DT>Xown</DT><DD>
Execute permission bit for the owner of a file,
search permission bit for the owner of a directory.
</DD>
<DT>Rgrp</DT><DD>
Read permission bit for the group class of the file or directory.
</DD>
<DT>Wgrp</DT><DD>
Write permission bit for the group class of the file or directory.
</DD>
<DT>Xgrp</DT><DD>
Execute permission bit for the group class of a file,
search permission bit for the group class of a directory.
</DD>
<DT>Rpub</DT><DD>
Public read permission bit for the file or directory.
</DD>
<DT>Wpub</DT><DD>
Public write permission bit for the file or directory.
</DD>
<DT>Xpub</DT><DD>
Public execute permission bit for the file,
public search permission bit for the directory.
<P>
</DD>
</DL>
The high-order bits of the mode are not used and must be clear.
<HR>
<H1><A NAME="HRR.4">ERRORS</A></H1>
In order to change any of the system properties of an object,
an exclusive lock is acquired for the object.
Deadlocks can occur while locks are being acquired.  
See .SA transaction(svas) 
for information about deadlocks.
<P>
Changing system properties of an object occurs on the server so that
the changes are immediate. 
<P>
A complete list of errors is in
<A HREF="errors.svas.html"><STRONG>errors(svas)</STRONG></A>.
<HR>
<H1><A NAME="HRR.5">ENVIRONMENT</A></H1>
All these methods are available on the client side and the
server side.
<HR>
<H1><A NAME="HRR.6">VERSION</A></H1>
This manual page applies to Version 1.1.1 of the Shore software.
<HR>
<H1><A NAME="HRR.7">SPONSORSHIP</A></H1>
The Shore project is sponsored by the Advanced Research Project Agency, ARPA
order number 018 (formerly 8230), monitored by the U.S. Army Research
Laboratory under contract DAAB07-91-C-Q518.
<HR>
<H1><A NAME="HRR.8">COPYRIGHT</A></H1>
Copyright &#169; 1994, 1995, 1996, 1997,
Computer Sciences Department, University of
Wisconsin -- Madison. All Rights Reserved.
<HR>
<H1><A NAME="HRR.9">SEE ALSO</A></H1>
<A HREF="sysprops.svas.html"><STRONG>sysprops(svas)</STRONG></A>
</BODY>
</HTML>
