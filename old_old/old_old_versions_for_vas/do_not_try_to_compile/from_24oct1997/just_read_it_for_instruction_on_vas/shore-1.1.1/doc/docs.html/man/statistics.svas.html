<!-- Warning: Do not edit this file. -->
<!-- It was created automatically by yam2html.pl 1.3  -->
<!-- on Mon Oct 27 09:41:04 CST 1997 from file mansvas/statistics.svas -->
<!DOCTYPE HTML public "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>
statistics(svas) -- Shore Reference Manual
</TITLE>
<LINK REV="made" HREF="mailto:solomon@cs.wisc.edu">
</HEAD>

<BODY>

<!-- .so tmac.man.local -->
<H1><A NAME="HRR.0">
statistics - Shore performance information
</A></H1><HR>
<H1>
CONTENTS
</H1>
<UL>
<LI>
<A HREF="#HRR.1">SYNOPSIS</A>
</LI>
<LI>
<A HREF="#HRR.2">DESCRIPTION</A>
</LI>
<LI>
<A HREF="#HRR.3">CLIENT STATISTICS</A>
<UL>
<LI>
<A HREF="#HRR.3.1">Batching statistics for TCP</A>
</LI>
</UL>
</LI>
<LI>
<A HREF="#HRR.4">SERVER STATISTICS</A>
</LI>
<LI>
<A HREF="#HRR.5">STATISTICS ON SERVER AND CLIENT</A>
</LI>
<LI>
<A HREF="#HRR.6">VERSION</A>
</LI>
<LI>
<A HREF="#HRR.7">SPONSORSHIP</A>
</LI>
<LI>
<A HREF="#HRR.8">COPYRIGHT</A>
</LI>
<LI>
<A HREF="#HRR.9">SEE ALSO</A>
</LI></UL><HR>
<H1><A NAME="HRR.1">SYNOPSIS</A></H1>
<BLOCKQUOTE><PRE>
pstats 
cstats
</PRE></BLOCKQUOTE>
<HR>
<H1><A NAME="HRR.2">DESCRIPTION</A></H1>
<P>
The above commands are commands to the Shore Value-Added Server
process's
Tcl shell (terminal interface).
The command
 <strong>pstats</strong>
prints a plethora of server statistics.
The command
 <strong>cstats</strong>
clears the statistics that are collected for the entire server.
Some statistics are collected for each client; those are not cleared,
and the per-client statistics disappear when the client disconnects
from the server.
The statistics are described below.
<P>
The Shore Value-Added Server also keeps myriad statistics
in the client process (library), which are also described here.
<P>
All the descriptions below include a name, which is also
a manifest constant that is available to Shore applications
that use the statistics-gathering programming interface (see
<A HREF="statistics.fc.html"><STRONG>statistics(fc)</STRONG></A>
).
<HR>
<H1><A NAME="HRR.3">CLIENT STATISTICS</A></H1>
<H2><A NAME="HRR.3.1">Batching statistics for TCP</A></H2>
<P>
This module describes the client library's batching
of update requests into single remote operations (RPCs).
These statistics are subject to change, as the 
interaction between the two processes becomes more sophisticated
and more parallelism is introduced in future releases.
<P>
<DL>
<DT>BATCH__hit_qmax</DT><DD>
The number of times the batch queue was flushed because it
reached its capacity (in number of requests).
</DD>
<DT>BATCH__hit_tcpmax</DT><DD>
The number of times the batch queue was flushed because the
socket buffer capacity was reached either
locally or at the server.
</DD>
<DT>BATCH__sent</DT><DD>
The number of times the batch queue was flushed because the
user requested it.
</DD>
<DT>BATCH__batches</DT><DD>
The total number of batches flushed (sent).
</DD>
<DT>BATCH__avgsent</DT><DD>
The average number of requests per batch.
</DD>
<DT>BATCH__queued</DT><DD>
The total number of requests batched. 
</DD>
<DT>BATCH__min_capacity</DT><DD>
The difference between the BATCH__max_capacity (below)
and the maximum number of bytes queued in the socket buffer.
</DD>
<DT>BATCH__max_q_len</DT><DD>
The capacity of the queue in number of requests.
</DD>
<DT>BATCH__max_capacity</DT><DD>
The capacity of the queue on number of bytes.
This is the smaller of the sizes of the local
socket buffer and the server's socket buffer.
<P>
</DD>
</DL>
The following module describes shared-memory
activity.  This applies only when the client process
and the server are running on the same machine, and
when shared memory has been allocated for communication
between the two processes (it is by default; you can
turn it off with options.)
(Using shared memory does not eliminate all use of TCP.)
<DL>
<DT>SHMBATCH__hit_shmmax</DT><DD>
The number of times the batch queue was flushed because there
was no more shared memory for storing requests.
<A HREF="options.svas.html"><STRONG>options(svas)</STRONG></A> 
for information about allocating shared memory for 
updates.
</DD>
<DT>SHMBATCH__whole</DT><DD>
Total shared memory allocated for batching requests.
</DD>
<DT>SHMBATCH__min_left</DT><DD>
The difference between the SHMBATCH__whole and 
and the maximum number of bytes queued in shared memory.

</DD>
</DL>
<HR>
<H1><A NAME="HRR.4">SERVER STATISTICS</A></H1>
<P>
The Shore threads package maintains the following statistics.
Many of them are of interest only to those people
who are writing value-added servers,
or to the Shore developers.
Many of these statistics will be removed in later
releases of Shore.

<DL>
<DT>STHREAD_namemallocs</DT><DD>
The number of times the package invoked a 
 <strong>fast malloc</strong>
for named threads.
(Threads are named to aid debugging.)
</DD>
<DT>STHREAD_ctxsw</DT><DD>
Context switches between threads.
</DD>
<DT>STHREAD_spins</DT><DD>
Times the process performed a busy-wait on 
a spin-lock (it contended with a `diskrw'
process for a mutual-exclusion variable).
</DD>
<DT>STHREAD_io</DT><DD>
Calls to perform disk I/O through a `diskrw'
process.
</DD>
<DT>STHREAD_ccio</DT><DD>
Concurrent calls to perform disk I/O.
</DD>
<DT>STHREAD_iowaits</DT><DD>
Times the server process waited for a
`diskrw' process to deliver its goods.
</DD>
<DT>STHREAD_selects</DT><DD>
Total number of Unix select() calls.
</DD>
<DT>STHREAD_selfound</DT><DD>
Times select returned before its timeout,
because a file descriptor was ready for input
or output.
</DD>
<DT>STHREAD_eintrs</DT><DD>
Times select was interrupted by a signal
(normally from the `diskrw' process).
</DD>
<DT>STHREAD_idle</DT><DD>
Times select() returned because its timeout
expired.
</DD>
<DT>STHREAD_zero</DT><DD>
Times the `diskrw' started and finished an operation
before the server called select().
(The server was busy while the I/O was being performed.)
</DD>
<DT>STHREAD_one</DT><DD>
Times the server called select() once between the
started and end of an I/O operation.
</DD>
<DT>STHREAD_two</DT><DD>
Times the server called select() twice between the
started and end of an I/O operation.
</DD>
<DT>STHREAD_three</DT><DD>
Times the server called select() three times between the
started and end of an I/O operation.
</DD>
<DT>STHREAD_more</DT><DD>
Times the server called select() more than three times between the
started and end of an I/O operation.
</DD>
<DT>STHREAD_wrapped</DT><DD>
Times the select counter wrapped.
<P>
</DD>
</DL>
The following statistics are kept by the
diskrw process (which you never see) and by the
server process. 
A value-added-server writer might modify the
`diskrw' process to print its statistics
for serious debugging, but in general,
the server's versions of these statistics
are adequate.
(The descriptions below are from the
server's point of view; the meanings
for the `diskrw' process are somewhat different.)
The server process notifies the `diskrw' process
that an I/O request is queued by sending a SIGUSR1 signal.
The `diskrw' process notifies the server
that the I/O request is satisfied by sending a SIGUSR2 signal.
Both processes use ALRM signals to poll their queues
every once-in-a-while if necessary.
<DL>
<DT>DISKRW_alarm</DT><DD>
ALRM signals received.
</DD>
<DT>DISKRW_notify</DT><DD>
SIGUSR1 sent to `diskrw' process.
</DD>
<DT>DISKRW_kicks</DT><DD>
SIGUSR2 received. 
</DD>
<DT>DISKRW_falarm</DT><DD>
Server found a message in a queue because of an ALRM signal.
</DD>
<DT>DISKRW_fnotify</DT><DD>
Server found a message in a queue because of a signal
from the other process (SIGUSR2).
</DD>
<DT>DISKRW_found</DT><DD>
Server found a message by polling the queue at any other time.
</DD>
<DT>DISKRW_lastsig</DT><DD>
The signal number of the last signal received from the `diskrw'
process.
</DD>
<DT>DISKRW_spins</DT><DD>
Not used by the server.

<P>
</DD>
</DL>
The Shore Storage Manager 
maintains a large set of statistics
described
in 
<A HREF="statistics.ssm.html"><STRONG>statistics(ssm)</STRONG></A>.
<P>
The RPC service keeps the following statistics:
<DL>
<DT>SVC_STAT_replies_success</DT><DD>
RPC replies indicating success.
</DD>
<DT>SVC_STAT_replies_noproc</DT><DD>
RPC replies indicating &quot;no such procedure&quot;.
</DD>
<DT>SVC_STAT_replies_noprog</DT><DD>
RPC replies indicating &quot;no such program&quot;.
</DD>
<DT>SVC_STAT_replies_progmismatch</DT><DD>
RPC replies indicating &quot;version mismatch&quot;.
</DD>
<DT>SVC_STAT_replies_nodecode</DT><DD>
RPC replies indicating &quot;couldn't decode request&quot;.
</DD>
<DT>SVC_STAT_replies_systemerr</DT><DD>
RPC replies indicating &quot;system error&quot;.
</DD>
<DT>SVC_STAT_replies_denied</DT><DD>
RPC replies indicating &quot;denied&quot; 
-- authentication failure.
</DD>
<DT>TCPSVC_STAT_replymax</DT><DD>
Largest reply sent over TCP.
</DD>
<DT>TCPSVC_STAT_reqmax</DT><DD>
Largest request received over TCP.
<P>
</DD>
</DL>
These are internal to the UDP RPC service and are subject to change:
<DL>
<DT>UDPSVC_STAT_cache_finds</DT><DD>
</DD>
<DT>UDPSVC_STAT_cache_nofinds</DT><DD>
</DD>
<DT>UDPSVC_STAT_cache_hits</DT><DD>
</DD>
<DT>UDPSVC_STAT_cache_misses</DT><DD>
</DD>
<DT>UDPSVC_STAT_cache_sets</DT><DD>
</DD>
<DT>UDPSVC_STAT_cache_presets</DT><DD>
</DD>
<DT>UDPSVC_STAT_cache_gets</DT><DD>
</DD>
<DT>UDPSVC_STAT_recvfroms</DT><DD>
<P>
</DD>
</DL>
These 
might be of interest to the user; they
apply only to the UDP services (MOUNTD and NFSD).
<DL>
<DT>UDPSVC_STAT_drops</DT><DD>
Number of requests dropped because for lack
of buffering capacity.
</DD>
<DT>UDPSVC_STAT_done</DT><DD>
Requests serviced.
</DD>
<DT>UDPSVC_STAT_replies</DT><DD>
Replies sent.
</DD>
<DT>UDPSVC_STAT_rereplies</DT><DD>
Re-transmitted replies.
</DD>
<DT>UDPSVC_STAT_retrans</DT><DD>
Number of different requests received having retransmissions.
</DD>
<DT>UDPSVC_STAT_retrans_total</DT><DD>
Total number of retransmitted requests received (for any
requests).
</DD>
<DT>UDPSVC_STAT_retrans_max</DT><DD>
Maximum number of retransmissions detected
for any given request.
</DD>
<DT>UDPSVC_STAT_replymax</DT><DD>
Largest reply sent over UDP.
</DD>
<DT>UDPSVC_STAT_reqmax</DT><DD>
Largest request received over UDP.
<P>
</DD>
</DL>
These statistics are kept for the NFS service:
<DL>
<DT>NFSD_lock_timeouts</DT><DD>
The number of times an operation could not be performed
because it would have to wait for lock.
</DD>
<DT>NFSD_nosuch_errors</DT><DD>
The number of errors for which there is no reasonable
NFS error response.
<P>
</DD>
</DL>
The module called
&quot;System properties cache (per-client)&quot;
will be removed in the next release.
<P>
The Shore value-added-server contains four modules
that serve different RPC interfaces:
NFS, MOUNT (for NFS), clients, and other Shore value-added servers.
For each of these services, there is a module that counts the
numbers of RPC requests received.

<HR>
<H1><A NAME="HRR.5">STATISTICS ON SERVER AND CLIENT</A></H1>
<P>
Both processes count the requests received.
In the client library, two sets of counts are kept:
one to reflect the local requests (&quot;Client Requests&quot;),
and another to reflect the remote operations, or requests forwarded
to the server (&quot;Messages Sent&quot;).
These two sets of numbers may differ because sometimes a single local
request is broken into several remote requests.
For example,
a request to create a very large object with initialized
data may result in a request to create an object 
followed by a series of write or append requests.
<P>
On the server, they reflect the remote operations
requested by the client (&quot;Client RPCs&quot;),
which might be less than the client's count because
some can be satisfied locally on the client.
Shore users are discouraged from using the
constants to print individual statistics in this
group
because the constants are generated by
the RPC package, and they change with each change
to the client-server protocol.
For that reason, we do not make the constants manifest.
Nevertheless, if you print the statistics from the
Shore server's terminal interface, or with the
object cache 
 <em>oc_pstats</em>
option,  you will see these counts.
<P>
The Unix resource usage statistics are collected and
reported in both processes.  The 
defined constants for these statistics are:
<DL>
<DT>UNIX_utime_tv_sec</DT><DD>
</DD>
<DT>UNIX_utime_tv_usec</DT><DD>
</DD>
<DT>UNIX_stime_tv_sec</DT><DD>
</DD>
<DT>UNIX_stime_tv_usec</DT><DD>
</DD>
<DT>UNIX_ru_idrss</DT><DD>
</DD>
<DT>UNIX_ru_minflt</DT><DD>
</DD>
<DT>UNIX_ru_majflt</DT><DD>
</DD>
<DT>UNIX_ru_nswap</DT><DD>
</DD>
<DT>UNIX_ru_inblock</DT><DD>
</DD>
<DT>UNIX_ru_oublock</DT><DD>
</DD>
<DT>UNIX_ru_msgsnd</DT><DD>
</DD>
<DT>UNIX_ru_msgrcv</DT><DD>
</DD>
<DT>UNIX_ru_nsignals</DT><DD>
</DD>
<DT>UNIX_ru_nvcsw</DT><DD>
</DD>
<DT>UNIX_ru_nivcsw</DT><DD>
</DD>
</DL>
<HR>
<H1><A NAME="HRR.6">VERSION</A></H1>
This manual page applies to Version 1.1.1 of the Shore software.
<HR>
<H1><A NAME="HRR.7">SPONSORSHIP</A></H1>
The Shore project is sponsored by the Advanced Research Project Agency, ARPA
order number 018 (formerly 8230), monitored by the U.S. Army Research
Laboratory under contract DAAB07-91-C-Q518.
<HR>
<H1><A NAME="HRR.8">COPYRIGHT</A></H1>
Copyright &#169; 1994, 1995, 1996, 1997,
Computer Sciences Department, University of
Wisconsin -- Madison. All Rights Reserved.
<HR>
<H1><A NAME="HRR.9">SEE ALSO</A></H1>
<A HREF="statistics.ssm.html"><STRONG>statistics(ssm)</STRONG></A>,
<A HREF="statistics.oc.html"><STRONG>statistics(oc)</STRONG></A>,
and
<A HREF="statistics.fc.html"><STRONG>statistics(fc)</STRONG></A>
</BODY>
</HTML>
