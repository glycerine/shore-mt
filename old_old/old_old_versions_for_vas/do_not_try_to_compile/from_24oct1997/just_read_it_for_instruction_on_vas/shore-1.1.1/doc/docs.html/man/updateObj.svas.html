<!-- Warning: Do not edit this file. -->
<!-- It was created automatically by yam2html.pl 1.3  -->
<!-- on Mon Oct 27 09:41:06 CST 1997 from file mansvas/updateObj.svas -->
<!DOCTYPE HTML public "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>
updateobj(svas) -- Shore Reference Manual
</TITLE>
<LINK REV="made" HREF="mailto:solomon@cs.wisc.edu">
</HEAD>

<BODY>

<!-- .so tmac.man.local -->
<H1><A NAME="HRR.0">
updateObj - combined write and append or trunc
</A></H1><HR>
<H1>
CONTENTS
</H1>
<UL>
<LI>
<A HREF="#HRR.1">SYNOPSIS</A>
</LI>
<LI>
<A HREF="#HRR.2">DESCRIPTION</A>
</LI>
<LI>
<A HREF="#HRR.3">ARGUMENTS</A>
</LI>
<LI>
<A HREF="#HRR.4">ENVIRONMENT</A>
</LI>
<LI>
<A HREF="#HRR.5">ERRORS</A>
</LI>
<LI>
<A HREF="#HRR.6">VERSION</A>
</LI>
<LI>
<A HREF="#HRR.7">SPONSORSHIP</A>
</LI>
<LI>
<A HREF="#HRR.8">COPYRIGHT</A>
</LI>
<LI>
<A HREF="#HRR.9">SEE ALSO</A>
</LI></UL><HR>
<H1><A NAME="HRR.1">SYNOPSIS</A></H1>
<BLOCKQUOTE><PRE>
// truncate followed by write:
VASResult shore_vas::updateObj(
            const  lrid_t     &amp;obj,
            ObjectOffset      offset,
            const  vec_t      &amp;wdata,
            ObjectSize        newlen,
            ObjectOffset      newtstart
        );     

// append followed by write:
VASResult shore_vas::updateObj(
            const  lrid_t     &amp;obj,     
            ObjectOffset      offset,
            const  vec_t      &amp;wdata,
            ObjectOffset      aoffset,
            const  vec_t      &amp;adata,
            ObjectOffset      newtstart
        ); 

</PRE></BLOCKQUOTE>
<HR>
<H1><A NAME="HRR.2">DESCRIPTION</A></H1>
 <strong>UpdateObj</strong>
combines two functions:
 <strong>truncObj</strong>
and
 <strong>writeObj</strong>
(in its first form),
or
 <strong>appendObj</strong>
and
 <strong>writeObj</strong>
(in its second form).
The purpose of combining these pairs of functions is to
reduce the number of remote operations performed when
these combinations of operations are apropos.
<HR>
<H1><A NAME="HRR.3">ARGUMENTS</A></H1>
The argument
 <em>obj</em>
is the full logical object identifier of the object to be read or
updated.
<P>
In the first form,
the argument
 <em>newlen</em>
indicates the desired length of the object after the
truncation occurs.
If this is larger than the size of the object before
truncation, the SVAS pads the object with zero-valued bytes
up to the desired length.
<P>
In the second form, the size of the object is increased
by appending the data given in
 <em>adata.</em>
This form of requires the value
 <em>aoffset</em>
to indicate the size of the object when the
function is called.
The reason for this is that the combined
vectors 
 <em>adata</em>
and 
 <em>wdata</em>
may
exceed internal limits on the
size of a remote request.
In that case,
the append portion of this request is accomplished
by a single append request with uninitialized data,
along with a set of smaller write requests.
<P>
The vectors may be empty.
<P>
 <strong>UpdateObj</strong>
can change the location and size
of the TEXT portion of the object.
The argument
 <em>newtstart</em>
indicates the new location
of the beginning of the TEXT attribute.
<P>
An exclusive lock is acquired by 
 <strong>updateObj.</strong>
<HR>
<H1><A NAME="HRR.4">ENVIRONMENT</A></H1>
All these methods are available
to both the server and to clients.
The argument
 <em>aoffset</em>
is ignored on the server.
<P>
Both forms of 
 <strong>updateObj</strong>
must be called when a transaction is active.
<HR>
<H1><A NAME="HRR.5">ERRORS</A></H1>
<P>
Deadlocks can occur while locks are being acquired.  See
<A HREF="transaction.svas.html"><STRONG>transaction(svas)</STRONG></A> 
for information about deadlocks.
<P>
A complete list of errors is in
<A HREF="errors.svas.html"><STRONG>errors(svas)</STRONG></A>.
<HR>
<H1><A NAME="HRR.6">VERSION</A></H1>
This manual page applies to Version 1.1.1 of the Shore software.
<HR>
<H1><A NAME="HRR.7">SPONSORSHIP</A></H1>
The Shore project is sponsored by the Advanced Research Project Agency, ARPA
order number 018 (formerly 8230), monitored by the U.S. Army Research
Laboratory under contract DAAB07-91-C-Q518.
<HR>
<H1><A NAME="HRR.8">COPYRIGHT</A></H1>
Copyright &#169; 1994, 1995, 1996, 1997,
Computer Sciences Department, University of
Wisconsin -- Madison. All Rights Reserved.
<HR>
<H1><A NAME="HRR.9">SEE ALSO</A></H1>
<A HREF="appendObj.svas.html"><STRONG>appendObj(svas)</STRONG></A>,
<A HREF="truncObj.svas.html"><STRONG>truncObj(svas)</STRONG></A>,
<A HREF="writeObj.svas.html"><STRONG>writeObj(svas)</STRONG></A>,
<A HREF="transaction.svas.html"><STRONG>transaction(svas)</STRONG></A>,
<A HREF="errors.svas.html"><STRONG>errors(svas)</STRONG></A>,
and
<A HREF="text.svas.html"><STRONG>text(svas)</STRONG></A>.
</BODY>
</HTML>
