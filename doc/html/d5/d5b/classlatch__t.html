<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Shore Storage Manager: latch_t Class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="../../modules.html"><span>Modules</span></a></li>
    <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="../../classes.html"><span>Classes</span></a></li>
    <li><a href="../../files.html"><span>Files</span></a></li>
    <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="../../examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="../../classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="../../annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="../../hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="../../functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>latch_t Class Reference</h1><!-- doxytag: class="latch_t" --><!-- doxytag: inherits="sthread_named_base_t" -->Inherits sthread_named_base_t.
<p>
Collaboration diagram for latch_t:<p><center><img src="../../da/d69/classlatch__t__coll__graph.png" border="0" usemap="#d1/df2/latch__t__coll__map" alt="Collaboration graph"></center>
<map name="d1/df2/latch__t__coll__map">
<area href="../../d9/d7f/classmcs__rwlock.html" shape="rect" coords="5,5,104,32" alt="">
</map>
<center><font size="2">[<a target="top" href="../../graph_legend.html">legend</a>]</font></center><a href="../../d4/d6c/classlatch__t-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
A short-term hold (exclusive or shared) on a page. 
<p>
A latch may be acquire()d multiple times by a single thread. The mode of subsequent acquire()s must be at or above the level of the currently held latch. Each of these individual locks must be released. <dl compact><dt><b>See also:</b></dt><dd><a class="el" href="../../df/d0c/classlatch__holder__t.html">latch_holder_t</a> </dd></dl>

<p>

<p>
Definition at line <a class="el" href="../../d4/dc7/latch_8h-source.html#l00139">139</a> of file <a class="el" href="../../d4/dc7/latch_8h-source.html">latch.h</a>.<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="93a675e2812b88decd26788f0dceef0a"></a><!-- doxytag: member="latch_t::latch_t" ref="93a675e2812b88decd26788f0dceef0a" args="(const char *const desc=0)" -->
NORET&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#93a675e2812b88decd26788f0dceef0a">latch_t</a> (const char *const desc=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a latch with the given name. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="79397ce654654ca8e846d992d307650c"></a><!-- doxytag: member="latch_t::~latch_t" ref="79397ce654654ca8e846d992d307650c" args="()" -->
NORET&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#79397ce654654ca8e846d992d307650c">~latch_t</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dffae1872cc318ecf03b1b978e14c720"></a><!-- doxytag: member="latch_t::print" ref="dffae1872cc318ecf03b1b978e14c720" args="(ostream &amp;) const " -->
ostream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#dffae1872cc318ecf03b1b978e14c720">print</a> (ostream &amp;) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2449da0cc800a07e429bcd783c7687b1"></a><!-- doxytag: member="latch_t::id" ref="2449da0cc800a07e429bcd783c7687b1" args="() const " -->
const void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#2449da0cc800a07e429bcd783c7687b1">id</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="886a95e08ad4ffb7d0eef5381e970279"></a><!-- doxytag: member="latch_t::setname" ref="886a95e08ad4ffb7d0eef5381e970279" args="(const char *const desc)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#886a95e08ad4ffb7d0eef5381e970279">setname</a> (const char *const desc)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Change the name of the latch. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">w_rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#fbbc6c791818fa6e703fa808740f7a23">latch_acquire</a> (latch_mode_t m, <a class="el" href="../../d8/d69/smthread_8h.html#cf834513ff7853bf96601820e038ec9a">sthread_t::timeout_in_ms</a> timeout=sthread_base_t::WAIT_FOREVER)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Acquire the latch in given mode.  <a href="#fbbc6c791818fa6e703fa808740f7a23"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">w_rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#96cf1b274c5d077d8761b0881e3bf0af">upgrade_if_not_block</a> (bool &amp;would_block)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Upgrade from SH to EX if it can be done w/o blocking.  <a href="#96cf1b274c5d077d8761b0881e3bf0af"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#d910644f3ec1dd20f42057e4473f51b8">downgrade</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert atomically an EX latch into an SH latch.  <a href="#d910644f3ec1dd20f42057e4473f51b8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#bc514eb4e99f43f29f2c16c0d1ff1a3c">latch_release</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">release the latch.  <a href="#bc514eb4e99f43f29f2c16c0d1ff1a3c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="4d3a98dfcc23d09651b302c602627c7f"></a><!-- doxytag: member="latch_t::is_latched" ref="4d3a98dfcc23d09651b302c602627c7f" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#4d3a98dfcc23d09651b302c602627c7f">is_latched</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unreliable, but helpful for some debugging. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9e13e5e6ab39668b00b679971572511f"></a><!-- doxytag: member="latch_t::latch_cnt" ref="9e13e5e6ab39668b00b679971572511f" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#9e13e5e6ab39668b00b679971572511f">latch_cnt</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of acquires. A thread may hold more than once. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="834ae474eb75cb9d4954bc5addf6c054"></a><!-- doxytag: member="latch_t::num_holders" ref="834ae474eb75cb9d4954bc5addf6c054" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#834ae474eb75cb9d4954bc5addf6c054">num_holders</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">How many threads hold the R/W lock. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="10338d94f82c54507495723bd312fab2"></a><!-- doxytag: member="latch_t::is_mine" ref="10338d94f82c54507495723bd312fab2" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#10338d94f82c54507495723bd312fab2">is_mine</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True iff held in EX mode. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="098c037681884ea42d27555146f2cc0a"></a><!-- doxytag: member="latch_t::held_by_me" ref="098c037681884ea42d27555146f2cc0a" args="() const " -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#098c037681884ea42d27555146f2cc0a">held_by_me</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True iff held in EX or SH mode. Actually, it returns the. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e0bb43a3e6fb708aaf8b4754df4006cc"></a><!-- doxytag: member="latch_t::mode" ref="e0bb43a3e6fb708aaf8b4754df4006cc" args="() const " -->
latch_mode_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#e0bb43a3e6fb708aaf8b4754df4006cc">mode</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">EX, SH, or NL (if not held at all). <br></td></tr>
<tr><td colspan="2"><br><h2>Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="fee17f889058e171b168b1a3a46e09dc"></a><!-- doxytag: member="latch_t::latch_mode_str" ref="fee17f889058e171b168b1a3a46e09dc" args="[3]" -->
static const char *const&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d5b/classlatch__t.html#fee17f889058e171b168b1a3a46e09dc">latch_mode_str</a> [3] = { &quot;NL&quot;, &quot;SH&quot;, &quot;EX&quot; }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">string names of modes. <br></td></tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="fbbc6c791818fa6e703fa808740f7a23"></a><!-- doxytag: member="latch_t::latch_acquire" ref="fbbc6c791818fa6e703fa808740f7a23" args="(latch_mode_t m, sthread_t::timeout_in_ms timeout=sthread_base_t::WAIT_FOREVER)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">w_rc_t</a> latch_t::latch_acquire           </td>
          <td>(</td>
          <td class="paramtype">latch_mode_t&nbsp;</td>
          <td class="paramname"> <em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/d69/smthread_8h.html#cf834513ff7853bf96601820e038ec9a">sthread_t::timeout_in_ms</a>&nbsp;</td>
          <td class="paramname"> <em>timeout</em> = <code>sthread_base_t::WAIT_FOREVER</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Acquire the latch in given mode. 
<p>
<dl compact><dt><b>See also:</b></dt><dd>timeout_t. </dd></dl>

<p>
Definition at line <a class="el" href="../../d1/d06/latch_8cpp-source.html#l00348">348</a> of file <a class="el" href="../../d1/d06/latch_8cpp-source.html">latch.cpp</a>.
<p>
References <a class="el" href="../../d7/d6e/classholder__search.html#7e4cdbcdb592bd893e9bce36ce5248f6">holder_search::value()</a>, and <a class="el" href="../../dd/d93/w__base_8h.html#bcf9bfdb4e430cecbbaf03b144448b60">w_assert1</a>.
<p>
Here is the call graph for this function:<p><center><img src="../../d5/d5b/classlatch__t_fbbc6c791818fa6e703fa808740f7a23_cgraph.png" border="0" usemap="#d5/d5b/classlatch__t_fbbc6c791818fa6e703fa808740f7a23_cgraph_map" alt=""></center>
<map name="d5/d5b/classlatch__t_fbbc6c791818fa6e703fa808740f7a23_cgraph_map">
<area href="../../d7/d6e/classholder__search.html#7e4cdbcdb592bd893e9bce36ce5248f6" shape="rect" coords="213,5,371,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="96cf1b274c5d077d8761b0881e3bf0af"></a><!-- doxytag: member="latch_t::upgrade_if_not_block" ref="96cf1b274c5d077d8761b0881e3bf0af" args="(bool &amp;would_block)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">w_rc_t</a> latch_t::upgrade_if_not_block           </td>
          <td>(</td>
          <td class="paramtype">bool &amp;&nbsp;</td>
          <td class="paramname"> <em>would_block</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Upgrade from SH to EX if it can be done w/o blocking. 
<p>
Returns bool indicating if it would have blocked, in which case the upgrade did not occur. If it didn't have to block, the upgrade did occur. <dl compact><dt><b>Note:</b></dt><dd>Does <b>not</b> increment the count. </dd></dl>

<p>
Definition at line <a class="el" href="../../d1/d06/latch_8cpp-source.html#l00356">356</a> of file <a class="el" href="../../d1/d06/latch_8cpp-source.html">latch.cpp</a>.
<p>
References <a class="el" href="../../db/dc7/classw__rc__t.html#5d0d34facd6f25c6093a15c59f1a8da2">w_rc_t::err_num()</a>, <a class="el" href="../../db/dc7/classw__rc__t.html#a1c11327f611544881a9e1314c67f9ad">w_rc_t::is_error()</a>, <a class="el" href="../../d1/d83/w__rc_8h.html#fa44e478deb4d8495c7cd036e56c8ee0">RC_AUGMENT</a>, <a class="el" href="../../d1/d83/w__rc_8h.html#0f25e1835ee19d3905bd8ee2d2f0c86c">RCOK</a>, <a class="el" href="../../d7/d6e/classholder__search.html#7e4cdbcdb592bd893e9bce36ce5248f6">holder_search::value()</a>, and <a class="el" href="../../dd/d93/w__base_8h.html#01957fe3f47297cc4c4f5cf87abd3888">w_assert3</a>.
<p>
Here is the call graph for this function:<p><center><img src="../../d5/d5b/classlatch__t_96cf1b274c5d077d8761b0881e3bf0af_cgraph.png" border="0" usemap="#d5/d5b/classlatch__t_96cf1b274c5d077d8761b0881e3bf0af_cgraph_map" alt=""></center>
<map name="d5/d5b/classlatch__t_96cf1b274c5d077d8761b0881e3bf0af_cgraph_map">
<area href="../../db/dc7/classw__rc__t.html#5d0d34facd6f25c6093a15c59f1a8da2" shape="rect" coords="279,5,407,32" alt="">
<area href="../../db/dc7/classw__rc__t.html#a1c11327f611544881a9e1314c67f9ad" shape="rect" coords="282,56,403,83" alt="">
<area href="../../d7/d6e/classholder__search.html#7e4cdbcdb592bd893e9bce36ce5248f6" shape="rect" coords="264,107,421,133" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="d910644f3ec1dd20f42057e4473f51b8"></a><!-- doxytag: member="latch_t::downgrade" ref="d910644f3ec1dd20f42057e4473f51b8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void latch_t::downgrade           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convert atomically an EX latch into an SH latch. 
<p>
Does not decrement the latch count. 
<p>
Definition at line <a class="el" href="../../d1/d06/latch_8cpp-source.html#l00547">547</a> of file <a class="el" href="../../d1/d06/latch_8cpp-source.html">latch.cpp</a>.
<p>
References <a class="el" href="../../d7/d6e/classholder__search.html#7e4cdbcdb592bd893e9bce36ce5248f6">holder_search::value()</a>, and <a class="el" href="../../dd/d93/w__base_8h.html#01957fe3f47297cc4c4f5cf87abd3888">w_assert3</a>.
<p>
Here is the call graph for this function:<p><center><img src="../../d5/d5b/classlatch__t_d910644f3ec1dd20f42057e4473f51b8_cgraph.png" border="0" usemap="#d5/d5b/classlatch__t_d910644f3ec1dd20f42057e4473f51b8_cgraph_map" alt=""></center>
<map name="d5/d5b/classlatch__t_d910644f3ec1dd20f42057e4473f51b8_cgraph_map">
<area href="../../d7/d6e/classholder__search.html#7e4cdbcdb592bd893e9bce36ce5248f6" shape="rect" coords="200,5,357,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="bc514eb4e99f43f29f2c16c0d1ff1a3c"></a><!-- doxytag: member="latch_t::latch_release" ref="bc514eb4e99f43f29f2c16c0d1ff1a3c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int latch_t::latch_release           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
release the latch. 
<p>
Decrements the latch count and releases only when it hits 0. Returns the resulting latch count. 
<p>
Definition at line <a class="el" href="../../d1/d06/latch_8cpp-source.html#l00388">388</a> of file <a class="el" href="../../d1/d06/latch_8cpp-source.html">latch.cpp</a>.
<p>
References <a class="el" href="../../d7/d6e/classholder__search.html#7e4cdbcdb592bd893e9bce36ce5248f6">holder_search::value()</a>, and <a class="el" href="../../dd/d93/w__base_8h.html#16e40294d356ca3669fe2020a3abaebc">w_assert2</a>.
<p>
Here is the call graph for this function:<p><center><img src="../../d5/d5b/classlatch__t_bc514eb4e99f43f29f2c16c0d1ff1a3c_cgraph.png" border="0" usemap="#d5/d5b/classlatch__t_bc514eb4e99f43f29f2c16c0d1ff1a3c_cgraph_map" alt=""></center>
<map name="d5/d5b/classlatch__t_bc514eb4e99f43f29f2c16c0d1ff1a3c_cgraph_map">
<area href="../../d7/d6e/classholder__search.html#7e4cdbcdb592bd893e9bce36ce5248f6" shape="rect" coords="213,5,371,32" alt="">
</map>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>src/common/<a class="el" href="../../d4/dc7/latch_8h-source.html">latch.h</a><li>src/common/<a class="el" href="../../d1/d06/latch_8cpp-source.html">latch.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jan 2 15:14:07 2012 for Shore Storage Manager by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
