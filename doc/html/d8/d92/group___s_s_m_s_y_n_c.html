<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Shore Storage Manager: Synchronization, Mutual Exclusion, Deadlocks</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="../../modules.html"><span>Modules</span></a></li>
    <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="../../classes.html"><span>Classes</span></a></li>
    <li><a href="../../files.html"><span>Files</span></a></li>
    <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="../../examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1>Synchronization, Mutual Exclusion, Deadlocks<br>
<small>
[<a class="el" href="../../d8/db7/group___m_i_s_c.html">Miscellaneous</a>]</small>
</h1>
<p>
Collaboration diagram for Synchronization, Mutual Exclusion, Deadlocks:<center><table><tr><td><img src="../../d8/d92/group___s_s_m_s_y_n_c.png" border="0" alt="" usemap="#d2/df8/d8_2d92_2group______s__s__m__s__y__n__c_map">
<map name="d2/df8/d8_2d92_2group______s__s__m__s__y__n__c_map">
<area href="../../d8/db7/group___m_i_s_c.html" shape="rect" coords="6,5,117,32" alt="">
</map></td></tr></table></center>
Within the storage manager are a variety of primitives that provide for ACID properties of transactions and for correct behavior of concurrent threads. These include:<ul>
<li>read-write locking primitives for concurrent threads (<a class="el" href="../../d5/d19/structocc__rwlock.html">occ_rwlock</a>, <a class="el" href="../../d9/d7f/classmcs__rwlock.html">mcs_rwlock</a>)</li><li>mutexes (pthread_mutex_t, queue_based_lock_t)</li><li>condition variables (pthread_cond_t)</li><li>latches (<a class="el" href="../../d5/d5b/classlatch__t.html">latch_t</a>)</li><li>database locks</li></ul>
<p>
The storage manager uses database locks to provide concurrency control among transactions; latches are used for syncronize concurrent threads' accesses to pages in the buffer pool. The storage manager's threads use carefully-designed orderings of the entities they "lock" with synchronization primitives to avoid any sort of deadlock. All synchronization primitives except data base locks are meant to be held for short durations; they are not even held for the duration of a disk write, for example.<p>
Deadlock detection is done only for database locks. Latches are covered by locks, which is to say that locks are acquired before latches are requested, so that deadlock detection in the lock manager is generally sufficient to prevent deadlocks among concurrent threads in a properly-written server.<p>
Care must be taken, when writing server code, to avoid deadlocks of other sorts such as latch-mutex, or latch-latch deadlocks. For example, multiple threads may cooperate on behalf of the same transaction; if they are trying to pin records without a well-designed ordering protocol, they may deadlock with one thread holding page A pinned (latched) and waiting to pin (latch) B, while the other holds B pinned and waits for a pin of A. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jan 2 15:14:02 2012 for Shore Storage Manager by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
