<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Shore Storage Manager: src/mainpage.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="../../modules.html"><span>Modules</span></a></li>
    <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="../../classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="../../files.html"><span>Files</span></a></li>
    <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="../../examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="../../globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="../../dir_ff5597eff5bf2afe4bf6bec877c08348.html">src</a></div>
<h1>mainpage.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*&lt;std-header orig-src='shore' incl-file-exclusion='MAINPAGE_H'&gt;</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment"> $Id: mainpage.h,v 1.15 2011/04/11 20:37:16 nhall Exp $</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">SHORE -- Scalable Heterogeneous Object REpository</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment">Copyright (c) 1994-99 Computer Sciences Department, University of</span>
<a name="l00008"></a>00008 <span class="comment">                      Wisconsin -- Madison</span>
<a name="l00009"></a>00009 <span class="comment">All Rights Reserved.</span>
<a name="l00010"></a>00010 <span class="comment"></span>
<a name="l00011"></a>00011 <span class="comment">Permission to use, copy, modify and distribute this software and its</span>
<a name="l00012"></a>00012 <span class="comment">documentation is hereby granted, provided that both the copyright</span>
<a name="l00013"></a>00013 <span class="comment">notice and this permission notice appear in all copies of the</span>
<a name="l00014"></a>00014 <span class="comment">software, derivative works or modified versions, and any portions</span>
<a name="l00015"></a>00015 <span class="comment">thereof, and that both notices appear in supporting documentation.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">THE AUTHORS AND THE COMPUTER SCIENCES DEPARTMENT OF THE UNIVERSITY</span>
<a name="l00018"></a>00018 <span class="comment">OF WISCONSIN - MADISON ALLOW FREE USE OF THIS SOFTWARE IN ITS</span>
<a name="l00019"></a>00019 <span class="comment">"AS IS" CONDITION, AND THEY DISCLAIM ANY LIABILITY OF ANY KIND</span>
<a name="l00020"></a>00020 <span class="comment">FOR ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.</span>
<a name="l00021"></a>00021 <span class="comment"></span>
<a name="l00022"></a>00022 <span class="comment">This software was developed with support by the Advanced Research</span>
<a name="l00023"></a>00023 <span class="comment">Project Agency, ARPA order number 018 (formerly 8230), monitored by</span>
<a name="l00024"></a>00024 <span class="comment">the U.S. Army Research Laboratory under contract DAAB07-91-C-Q518.</span>
<a name="l00025"></a>00025 <span class="comment">Further funding for this work was provided by DARPA through</span>
<a name="l00026"></a>00026 <span class="comment">Rome Research Laboratory Contract No. F30602-97-2-0247.</span>
<a name="l00027"></a>00027 <span class="comment"></span>
<a name="l00028"></a>00028 <span class="comment">*/</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="comment">/* this file contains only Doxygen documentation */</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="comment"></span>
<a name="l00033"></a>00033 <span class="comment">/**\page COPYRIGHT Copyrights and Licenses </span>
<a name="l00034"></a>00034 <span class="comment"> *</span>
<a name="l00035"></a>00035 <span class="comment">The main code base of the storage manager is subject to the SHORE/UW </span>
<a name="l00036"></a>00036 <span class="comment">copyright (given below) and most of it is also subject to </span>
<a name="l00037"></a>00037 <span class="comment">the SHORE-MT/DIAS copyright (also given below).</span>
<a name="l00038"></a>00038 <span class="comment">Both copyrights are hereby extended to the date of this release, 2010.</span>
<a name="l00039"></a>00039 <span class="comment"></span>
<a name="l00040"></a>00040 <span class="comment">The atomic operations library is taken from the OPENSOLARIS release and</span>
<a name="l00041"></a>00041 <span class="comment">is subject to Sun Microsystems copyright, and to the OPENSOLARIS license,</span>
<a name="l00042"></a>00042 <span class="comment">found in src/atomic_ops/OPENSOLARIS.LICENSE.</span>
<a name="l00043"></a>00043 <span class="comment">It is lengthy and so it is not included here.</span>
<a name="l00044"></a>00044 <span class="comment"></span>
<a name="l00045"></a>00045 <span class="comment">The strstream compatibility code found in src/fc/w_compat_strstream.h and</span>
<a name="l00046"></a>00046 <span class="comment">src/fc/w_compat_strstream.cpp</span>
<a name="l00047"></a>00047 <span class="comment">is subject to the Silicon Graphics copyright, below.</span>
<a name="l00048"></a>00048 <span class="comment"></span>
<a name="l00049"></a>00049 <span class="comment">The regex code found in the src/common/ library is subject to the </span>
<a name="l00050"></a>00050 <span class="comment">Henry Spencer/ATT copyright and license, contained in src/common/regex2.h, and</span>
<a name="l00051"></a>00051 <span class="comment">included below.</span>
<a name="l00052"></a>00052 <span class="comment"></span>
<a name="l00053"></a>00053 <span class="comment">What little remains of the old SHORE sthreads library is subject to</span>
<a name="l00054"></a>00054 <span class="comment">copyright given in those source files (src/sthread/sthread.h) as well as to the SHORE/UW and</span>
<a name="l00055"></a>00055 <span class="comment">SHORE-MT/DIAS copyrights.</span>
<a name="l00056"></a>00056 <span class="comment"></span>
<a name="l00057"></a>00057 <span class="comment"></span>
<a name="l00058"></a>00058 <span class="comment"> -       \b SHORE/UW \b Copyright:</span>
<a name="l00059"></a>00059 <span class="comment"></span>
<a name="l00060"></a>00060 <span class="comment">SHORE -- Scalable Heterogeneous Object REpository</span>
<a name="l00061"></a>00061 <span class="comment"></span>
<a name="l00062"></a>00062 <span class="comment">Copyright (c) 1994-2010 Computer Sciences Department, University of</span>
<a name="l00063"></a>00063 <span class="comment">                      Wisconsin -- Madison</span>
<a name="l00064"></a>00064 <span class="comment">All Rights Reserved.</span>
<a name="l00065"></a>00065 <span class="comment"></span>
<a name="l00066"></a>00066 <span class="comment">Permission to use, copy, modify and distribute this software and its</span>
<a name="l00067"></a>00067 <span class="comment">documentation is hereby granted, provided that both the copyright</span>
<a name="l00068"></a>00068 <span class="comment">notice and this permission notice appear in all copies of the</span>
<a name="l00069"></a>00069 <span class="comment">software, derivative works or modified versions, and any portions</span>
<a name="l00070"></a>00070 <span class="comment">thereof, and that both notices appear in supporting documentation.</span>
<a name="l00071"></a>00071 <span class="comment"></span>
<a name="l00072"></a>00072 <span class="comment">THE AUTHORS AND THE COMPUTER SCIENCES DEPARTMENT OF THE UNIVERSITY</span>
<a name="l00073"></a>00073 <span class="comment">OF WISCONSIN - MADISON ALLOW FREE USE OF THIS SOFTWARE IN ITS</span>
<a name="l00074"></a>00074 <span class="comment">"AS IS" CONDITION, AND THEY DISCLAIM ANY LIABILITY OF ANY KIND</span>
<a name="l00075"></a>00075 <span class="comment">FOR ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.</span>
<a name="l00076"></a>00076 <span class="comment"></span>
<a name="l00077"></a>00077 <span class="comment">This software was developed with support by the Advanced Research</span>
<a name="l00078"></a>00078 <span class="comment">Project Agency, ARPA order number 018 (formerly 8230), monitored by</span>
<a name="l00079"></a>00079 <span class="comment">the U.S. Army Research Laboratory under contract DAAB07-91-C-Q518.</span>
<a name="l00080"></a>00080 <span class="comment">Further funding for this work was provided by DARPA through</span>
<a name="l00081"></a>00081 <span class="comment">Rome Research Laboratory Contract No. F30602-97-2-0247.</span>
<a name="l00082"></a>00082 <span class="comment"></span>
<a name="l00083"></a>00083 <span class="comment"> -       \b SHORE-MT/DIAS \b Copyright:</span>
<a name="l00084"></a>00084 <span class="comment"></span>
<a name="l00085"></a>00085 <span class="comment">Shore-MT -- Multi-threaded port of the SHORE storage manager</span>
<a name="l00086"></a>00086 <span class="comment"></span>
<a name="l00087"></a>00087 <span class="comment">                   Copyright (c) 2007-2009</span>
<a name="l00088"></a>00088 <span class="comment">  Data Intensive Applications and Systems Labaratory (DIAS)</span>
<a name="l00089"></a>00089 <span class="comment">           Ecole Polytechnique Federale de Lausanne</span>
<a name="l00090"></a>00090 <span class="comment"></span>
<a name="l00091"></a>00091 <span class="comment">                     All Rights Reserved.</span>
<a name="l00092"></a>00092 <span class="comment"></span>
<a name="l00093"></a>00093 <span class="comment">Permission to use, copy, modify and distribute this software and</span>
<a name="l00094"></a>00094 <span class="comment">its documentation is hereby granted, provided that both the</span>
<a name="l00095"></a>00095 <span class="comment">copyright notice and this permission notice appear in all copies of</span>
<a name="l00096"></a>00096 <span class="comment">the software, derivative works or modified versions, and any</span>
<a name="l00097"></a>00097 <span class="comment">portions thereof, and that both notices appear in supporting</span>
<a name="l00098"></a>00098 <span class="comment">documentation.</span>
<a name="l00099"></a>00099 <span class="comment"></span>
<a name="l00100"></a>00100 <span class="comment">This code is distributed in the hope that it will be useful, but</span>
<a name="l00101"></a>00101 <span class="comment">WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00102"></a>00102 <span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. THE AUTHORS</span>
<a name="l00103"></a>00103 <span class="comment">DISCLAIM ANY LIABILITY OF ANY KIND FOR ANY DAMAGES WHATSOEVER</span>
<a name="l00104"></a>00104 <span class="comment">RESULTING FROM THE USE OF THIS SOFTWARE.</span>
<a name="l00105"></a>00105 <span class="comment"></span>
<a name="l00106"></a>00106 <span class="comment"></span>
<a name="l00107"></a>00107 <span class="comment"> -       \b Silicon \b Graphic \b Copyright \b and \b License:</span>
<a name="l00108"></a>00108 <span class="comment"></span>
<a name="l00109"></a>00109 <span class="comment"> Copyright (c) 1998</span>
<a name="l00110"></a>00110 <span class="comment"> Silicon Graphics Computer Systems, Inc.</span>
<a name="l00111"></a>00111 <span class="comment"></span>
<a name="l00112"></a>00112 <span class="comment"> Permission to use, copy, modify, distribute and sell this software</span>
<a name="l00113"></a>00113 <span class="comment"> and its documentation for any purpose is hereby granted without fee,</span>
<a name="l00114"></a>00114 <span class="comment"> provided that the above copyright notice appear in all copies and</span>
<a name="l00115"></a>00115 <span class="comment"> that both that copyright notice and this permission notice appear</span>
<a name="l00116"></a>00116 <span class="comment"> in supporting documentation.  Silicon Graphics makes no</span>
<a name="l00117"></a>00117 <span class="comment"> representations about the suitability of this software for any</span>
<a name="l00118"></a>00118 <span class="comment"> purpose.  It is provided "as is" without express or implied warranty.</span>
<a name="l00119"></a>00119 <span class="comment"></span>
<a name="l00120"></a>00120 <span class="comment"> -       \b Henry \b Spencer/ATT \b Copyright \b and \b License:</span>
<a name="l00121"></a>00121 <span class="comment"></span>
<a name="l00122"></a>00122 <span class="comment">Copyright 1992, 1993, 1994, 1997 Henry Spencer.  All rights reserved.</span>
<a name="l00123"></a>00123 <span class="comment">This software is not subject to any license of the American Telephone</span>
<a name="l00124"></a>00124 <span class="comment">and Telegraph Company or of the Regents of the University of California.</span>
<a name="l00125"></a>00125 <span class="comment"></span>
<a name="l00126"></a>00126 <span class="comment">Permission is granted to anyone to use this software for any purpose on</span>
<a name="l00127"></a>00127 <span class="comment">any computer system, and to alter it and redistribute it, subject</span>
<a name="l00128"></a>00128 <span class="comment">to the following restrictions:</span>
<a name="l00129"></a>00129 <span class="comment"></span>
<a name="l00130"></a>00130 <span class="comment">1. The author is not responsible for the consequences of use of this</span>
<a name="l00131"></a>00131 <span class="comment">   software, no matter how awful, even if they arise from flaws in it.</span>
<a name="l00132"></a>00132 <span class="comment"></span>
<a name="l00133"></a>00133 <span class="comment">2. The origin of this software must not be misrepresented, either by</span>
<a name="l00134"></a>00134 <span class="comment">   explicit claim or by omission.  Since few users ever read sources,</span>
<a name="l00135"></a>00135 <span class="comment">   credits must appear in the documentation.</span>
<a name="l00136"></a>00136 <span class="comment"></span>
<a name="l00137"></a>00137 <span class="comment">3. Altered versions must be plainly marked as such, and must not be</span>
<a name="l00138"></a>00138 <span class="comment">   misrepresented as being the original software.  Since few users</span>
<a name="l00139"></a>00139 <span class="comment">   ever read sources, credits must appear in the documentation.</span>
<a name="l00140"></a>00140 <span class="comment"></span>
<a name="l00141"></a>00141 <span class="comment">4. This notice may not be removed or altered.</span>
<a name="l00142"></a>00142 <span class="comment"></span>
<a name="l00143"></a>00143 <span class="comment"> * */</span><span class="comment"></span>
<a name="l00144"></a>00144 <span class="comment">/** \mainpage SHORE Storage Manager: The Multi-Threaded Version </span>
<a name="l00145"></a>00145 <span class="comment"> * \section Brief Description</span>
<a name="l00146"></a>00146 <span class="comment"> *</span>
<a name="l00147"></a>00147 <span class="comment"> * This is an experiment test-bed library for use by researchers who wish to</span>
<a name="l00148"></a>00148 <span class="comment"> * write multi-threaded software that manages persistent data.   </span>
<a name="l00149"></a>00149 <span class="comment"> *</span>
<a name="l00150"></a>00150 <span class="comment"> * This storage engine provides the following capabilities:</span>
<a name="l00151"></a>00151 <span class="comment"> *  - transactions with ACID properties, with ARIES-based logging and recovery,</span>
<a name="l00152"></a>00152 <span class="comment"> *  primitives for partial rollback,</span>
<a name="l00153"></a>00153 <span class="comment"> *  transaction chaining, and early lock release,</span>
<a name="l00154"></a>00154 <span class="comment"> *  - prepared-transaction support for two-phased commit,</span>
<a name="l00155"></a>00155 <span class="comment"> *  - persistent storage structures : </span>
<a name="l00156"></a>00156 <span class="comment"> *  B+ tree indexes, R* trees (spatial indexes), and files of untyped records,</span>
<a name="l00157"></a>00157 <span class="comment"> *  - fine-grained locking for records and B+ tree indexes with deadlock detection,</span>
<a name="l00158"></a>00158 <span class="comment"> *  optional lock escalation and optional coarse-grained locking, </span>
<a name="l00159"></a>00159 <span class="comment"> *  - in-memory buffer management with optional prefetching, </span>
<a name="l00160"></a>00160 <span class="comment"> *  - extensible statistics-gathering, option-processing, and error-handling </span>
<a name="l00161"></a>00161 <span class="comment"> *  facilities.</span>
<a name="l00162"></a>00162 <span class="comment"> *</span>
<a name="l00163"></a>00163 <span class="comment"> * This software runs on Pthreads, thereby providing its client software</span>
<a name="l00164"></a>00164 <span class="comment"> * (e.g., a database server) multi-threading</span>
<a name="l00165"></a>00165 <span class="comment"> * capabilities and resulting scalability from modern SMP and NUMA </span>
<a name="l00166"></a>00166 <span class="comment"> * architectures, and has been used on Linux/x86-64 and Solaris/Niagara</span>
<a name="l00167"></a>00167 <span class="comment"> * architectures.</span>
<a name="l00168"></a>00168 <span class="comment"> *</span>
<a name="l00169"></a>00169 <span class="comment"> * \section Background</span>
<a name="l00170"></a>00170 <span class="comment"> *</span>
<a name="l00171"></a>00171 <span class="comment"> * The SHORE (Scalable Heterogeneous Object REpository) project</span>
<a name="l00172"></a>00172 <span class="comment"> * at the University of Wisconsin - Madison Department of Computer Sciences</span>
<a name="l00173"></a>00173 <span class="comment"> * produced the first release</span>
<a name="l00174"></a>00174 <span class="comment"> * of this storage manager as part of the full SHORE release in 1996.</span>
<a name="l00175"></a>00175 <span class="comment"> * The storage manager portion of the SHORE project was used by </span>
<a name="l00176"></a>00176 <span class="comment"> * other projects at the UW and elsewhere, and was intermittently</span>
<a name="l00177"></a>00177 <span class="comment"> * maintained through 2008.</span>
<a name="l00178"></a>00178 <span class="comment"> *</span>
<a name="l00179"></a>00179 <span class="comment"> * The SHORE Storage Manager was originally developed on single-cpu Unix-based systems,</span>
<a name="l00180"></a>00180 <span class="comment"> * providing support for "value-added" cooperating peer servers, which were processes</span>
<a name="l00181"></a>00181 <span class="comment"> * on single-CPU machines.  One such server was the</span>
<a name="l00182"></a>00182 <span class="comment"> * SHORE Value-Added Server (http://research.cs.wisc.edu/shore), and another of which was </span>
<a name="l00183"></a>00183 <span class="comment"> * Paradise (http://research.cs.wisc.edu/paradise) at the University of Wisconsin.</span>
<a name="l00184"></a>00184 <span class="comment"> * The</span>
<a name="l00185"></a>00185 <span class="comment"> * TIMBER (http://www.eecs.umich.edu/db/timber, and http://dx.doi.org/10.1007/s00778-002-0081-x) and </span>
<a name="l00186"></a>00186 <span class="comment"> * Pericope (http://www.eecs.umich.edu/periscope) projects </span>
<a name="l00187"></a>00187 <span class="comment"> * at the University of Michigan, </span>
<a name="l00188"></a>00188 <span class="comment"> * PREDATOR (http://www.distlab.dk/predator) at Cornell,</span>
<a name="l00189"></a>00189 <span class="comment"> * Lachesis (http://www.vldb.org/conf/2003/papers/S21P03.pdf)</span>
<a name="l00190"></a>00190 <span class="comment"> * BODHI (http://dsl.serciisc.ernet.in/projects/BODHI/homepage/index.html, http://doi.acm.org/10.1145/1007568.1007717)</span>
<a name="l00191"></a>00191 <span class="comment"> * used the SHORE Storage Manager.</span>
<a name="l00192"></a>00192 <span class="comment"> * The storage manager has been used for innumerable published studies since</span>
<a name="l00193"></a>00193 <span class="comment"> * then.</span>
<a name="l00194"></a>00194 <span class="comment"> *</span>
<a name="l00195"></a>00195 <span class="comment"> * The storage manager had its own (non-preemptive) threads library, which</span>
<a name="l00196"></a>00196 <span class="comment"> * forked a per-disk cooperating process to provide non-blocking I/O. </span>
<a name="l00197"></a>00197 <span class="comment"> * The storage manager also had a communications library for peer-server communication. </span>
<a name="l00198"></a>00198 <span class="comment"> * Until recently, the code structure, nomenclature, </span>
<a name="l00199"></a>00199 <span class="comment"> * and contents reflected its SHORE roots.</span>
<a name="l00200"></a>00200 <span class="comment"> *</span>
<a name="l00201"></a>00201 <span class="comment"> * In 2007, the Data Intensive Applications and Systems Labaratory (DIAS)</span>
<a name="l00202"></a>00202 <span class="comment"> * at Ecole Polytechnique Federale de Lausanne</span>
<a name="l00203"></a>00203 <span class="comment"> * began work on a port of release 5.0.1 of the storage manager to Pthreads,</span>
<a name="l00204"></a>00204 <span class="comment"> * and developed more scalable synchronization primitives, identified</span>
<a name="l00205"></a>00205 <span class="comment"> * bottlenecks in the storage manager, and improved the scalability of </span>
<a name="l00206"></a>00206 <span class="comment"> * the code.</span>
<a name="l00207"></a>00207 <span class="comment"> * This work was on a Solaris/Niagara platform and was released as Shore-MT</span>
<a name="l00208"></a>00208 <span class="comment"> * http://diaswww.epfl.ch/shore-mt).</span>
<a name="l00209"></a>00209 <span class="comment"> * It was a partial port of the storage manager and did not include documentation.</span>
<a name="l00210"></a>00210 <span class="comment"> * Projects using Shore-MT include</span>
<a name="l00211"></a>00211 <span class="comment"> * StagedDB/CMP (http://www.cs.cmu.edu/~stageddb/),</span>
<a name="l00212"></a>00212 <span class="comment"> * DORA (http://www.cs.cmu.edu/~ipandis/resources/pvldb10pandis.pdf)</span>
<a name="l00213"></a>00213 <span class="comment"> *</span>
<a name="l00214"></a>00214 <span class="comment"> * In 2009, the University of Wisconsin - Madison (UW) took the first Shore-MT</span>
<a name="l00215"></a>00215 <span class="comment"> * release and ported the remaining code to Pthreads.</span>
<a name="l00216"></a>00216 <span class="comment"> * This work as done on a Red Hat Linux/x86-64 platform.</span>
<a name="l00217"></a>00217 <span class="comment"> * The UW and DIAS cooperated on bug fixes and some internal</span>
<a name="l00218"></a>00218 <span class="comment"> * rewrites.</span>
<a name="l00219"></a>00219 <span class="comment"> * This release is the result of that work, and includes this documentation,</span>
<a name="l00220"></a>00220 <span class="comment"> * bug fixes, and supporting test code.   </span>
<a name="l00221"></a>00221 <span class="comment"> *</span>
<a name="l00222"></a>00222 <span class="comment"> * \section Copyrights Copyrights and Licenses</span>
<a name="l00223"></a>00223 <span class="comment"> *</span>
<a name="l00224"></a>00224 <span class="comment">This distribution contains code and documentation subject to several copyrights and licenses.</span>
<a name="l00225"></a>00225 <span class="comment">See the copyrights page \ref COPYRIGHT "Copyrights and Licenses, here".</span>
<a name="l00226"></a>00226 <span class="comment"></span>
<a name="l00227"></a>00227 <span class="comment"> *</span>
<a name="l00228"></a>00228 <span class="comment"> * \section START Getting Started With the Shore Storage Manager</span>
<a name="l00229"></a>00229 <span class="comment"> * A good place to start is with the programming interface, described \ref SSMAPI "here".</span>
<a name="l00230"></a>00230 <span class="comment"> *</span>
<a name="l00231"></a>00231 <span class="comment"> *\section BUILD Configuring and Building the Storage Manager</span>
<a name="l00232"></a>00232 <span class="comment"> * See \ref OPT "this page" to configure and build the storage manager.</span>
<a name="l00233"></a>00233 <span class="comment"> *</span>
<a name="l00234"></a>00234 <span class="comment"> * \section IMPLNOTES1 Implementation Notes</span>
<a name="l00235"></a>00235 <span class="comment"> * See \ref IMPLNOTES "this page" for some implementation details.</span>
<a name="l00236"></a>00236 <span class="comment"> *</span>
<a name="l00237"></a>00237 <span class="comment"> * \section BUGREPORT Reporting Bugs</span>
<a name="l00238"></a>00238 <span class="comment"> * This is unsupported software.  We hope there will be times when someone will</span>
<a name="l00239"></a>00239 <span class="comment"> * be able to respond to problem reports.</span>
<a name="l00240"></a>00240 <span class="comment"> * A problem report should include the following information:</span>
<a name="l00241"></a>00241 <span class="comment"> * - Release number/version of the storage manager.</span>
<a name="l00242"></a>00242 <span class="comment"> * - Platform (operating system, hardware/CPU type).</span>
<a name="l00243"></a>00243 <span class="comment"> * - Configuration options (command used to build the storage manager).</span>
<a name="l00244"></a>00244 <span class="comment"> * - Copy of program that demonstrates problematic behavior, if possible (if</span>
<a name="l00245"></a>00245 <span class="comment"> *   not itself part of the release).</span>
<a name="l00246"></a>00246 <span class="comment"> * - Description of problematic behavior, and how the program is run to</span>
<a name="l00247"></a>00247 <span class="comment"> *    reproduce the behavior.  If you can create a script to reproduce the</span>
<a name="l00248"></a>00248 <span class="comment"> *    problem, include that.</span>
<a name="l00249"></a>00249 <span class="comment"> *</span>
<a name="l00250"></a>00250 <span class="comment"> * Mail this to: shore-mt@cs.wisc.edu</span>
<a name="l00251"></a>00251 <span class="comment"> *</span>
<a name="l00252"></a>00252 <span class="comment"> * \section REFS References</span>
<a name="l00253"></a>00253 <span class="comment"> * See \ref REFERENCES "this page" for references to selected papers </span>
<a name="l00254"></a>00254 <span class="comment"> * from which ideas are used in the Shore Storage Manager. </span>
<a name="l00255"></a>00255 <span class="comment"> */</span>
<a name="l00256"></a>00256 <span class="comment"></span>
<a name="l00257"></a>00257 <span class="comment">/**\addtogroup OPT</span>
<a name="l00258"></a>00258 <span class="comment"> * Configuring and building the storage manager consists of these steps,</span>
<a name="l00259"></a>00259 <span class="comment"> * all done at the root of the distribution directory tree.</span>
<a name="l00260"></a>00260 <span class="comment"> * - bootstrap</span>
<a name="l00261"></a>00261 <span class="comment"> * - configure</span>
<a name="l00262"></a>00262 <span class="comment"> * - build (make)</span>
<a name="l00263"></a>00263 <span class="comment"> *</span>
<a name="l00264"></a>00264 <span class="comment"> *\section OPTBOOT Bootstrapping </span>
<a name="l00265"></a>00265 <span class="comment"> * Bootstrapping might not be necessary, but if you have the autotools</span>
<a name="l00266"></a>00266 <span class="comment"> * installed, it might save time to bootstrap the first time you try to </span>
<a name="l00267"></a>00267 <span class="comment"> * build, particularly if you are installing on a system other than Linux.</span>
<a name="l00268"></a>00268 <span class="comment"> * To bootstrap, type ./bootstrap. You can also look at that script and</span>
<a name="l00269"></a>00269 <span class="comment"> * run selected parts of it, since all it does is run the autotools.</span>
<a name="l00270"></a>00270 <span class="comment"> *</span>
<a name="l00271"></a>00271 <span class="comment"> * Autotools run abysmally slowly on Solaris.</span>
<a name="l00272"></a>00272 <span class="comment"> *</span>
<a name="l00273"></a>00273 <span class="comment"> *\section OPTCONF Configuring </span>
<a name="l00274"></a>00274 <span class="comment"> * There are two parts to configuring the storage manager.</span>
<a name="l00275"></a>00275 <span class="comment"> * The original configuration scheme of SHORE was encapsulated in</span>
<a name="l00276"></a>00276 <span class="comment"> * \e config/shore.def, which described all or most pertinent CPP macros. </span>
<a name="l00277"></a>00277 <span class="comment"> * We are moving away from that scheme and replacing it with</span>
<a name="l00278"></a>00278 <span class="comment"> * autoconf options and features, but a few things still remain under</span>
<a name="l00279"></a>00279 <span class="comment"> * the control of \e shore.def.</span>
<a name="l00280"></a>00280 <span class="comment"> * These fall into three categories:</span>
<a name="l00281"></a>00281 <span class="comment"> *     - details related to autoconf-controlled options, such as pathnames</span>
<a name="l00282"></a>00282 <span class="comment"> *     - basic compile-time constants that someone extending the</span>
<a name="l00283"></a>00283 <span class="comment"> *       storage manager might want to change </span>
<a name="l00284"></a>00284 <span class="comment"> *     - maintainer's tools</span>
<a name="l00285"></a>00285 <span class="comment"> *</span>
<a name="l00286"></a>00286 <span class="comment"> * There remaining some CPP macros not </span>
<a name="l00287"></a>00287 <span class="comment"> * described in \e config/shore.def:</span>
<a name="l00288"></a>00288 <span class="comment"> *      - code of occasional utility for debugging purposes</span>
<a name="l00289"></a>00289 <span class="comment"> *      - code intended to be the subject of future experimentation</span>
<a name="l00290"></a>00290 <span class="comment"> *</span>
<a name="l00291"></a>00291 <span class="comment"> * Configuring amounts to running ./configure from the root of the</span>
<a name="l00292"></a>00292 <span class="comment"> * distribution directory tree, and, depending on the features you </span>
<a name="l00293"></a>00293 <span class="comment"> * wish to use, editing \e config/shore.def.</span>
<a name="l00294"></a>00294 <span class="comment"> *</span>
<a name="l00295"></a>00295 <span class="comment"> * \remarks</span>
<a name="l00296"></a>00296 <span class="comment"> * The storage manager API contains a method ss_m::config_info (q.v.) that</span>
<a name="l00297"></a>00297 <span class="comment"> * allows a server to determine, at run time, some of the</span>
<a name="l00298"></a>00298 <span class="comment"> * compile-time limits determined by the configuration.</span>
<a name="l00299"></a>00299 <span class="comment"> *</span>
<a name="l00300"></a>00300 <span class="comment"> *\subsection CONFIGOPT Configuration Options</span>
<a name="l00301"></a>00301 <span class="comment"> * To find the configuration options, type </span>
<a name="l00302"></a>00302 <span class="comment"> *\code ./configure --help \endcode, the output of which is reproduced here.</span>
<a name="l00303"></a>00303 <span class="comment"> *</span>
<a name="l00304"></a>00304 <span class="comment"> * \verbatim</span>
<a name="l00305"></a>00305 <span class="comment">SHORE-specific Features:</span>
<a name="l00306"></a>00306 <span class="comment">  --enable-pthread-mutex default:yes    Compile to use pthreads for mutexes for</span>
<a name="l00307"></a>00307 <span class="comment">                                        certain critical sections.</span>
<a name="l00308"></a>00308 <span class="comment">  --enable-lp64         default:yes     Compile to use LP 64 data model</span>
<a name="l00309"></a>00309 <span class="comment">                                        No other data model is supported yet.</span>
<a name="l00310"></a>00310 <span class="comment">                                        But we hope some day to port back to LP32.</span>
<a name="l00311"></a>00311 <span class="comment">  --enable-checkrc      default:no      Generate (expensive) code to verify return-code checking</span>
<a name="l00312"></a>00312 <span class="comment">                                        If a w_rc_t is set but not checked with</span>
<a name="l00313"></a>00313 <span class="comment">                                        method is_error(), upon destruction the</span>
<a name="l00314"></a>00314 <span class="comment">                                        w_rc_t will print a message to the effect</span>
<a name="l00315"></a>00315 <span class="comment">                                        "error not checked".</span>
<a name="l00316"></a>00316 <span class="comment">  --enable-trace        default:no      Include tracing code</span>
<a name="l00317"></a>00317 <span class="comment">                                        Run-time costly.  Good for debugging</span>
<a name="l00318"></a>00318 <span class="comment">                                        problems that are not timing-dependent.</span>
<a name="l00319"></a>00319 <span class="comment">                                        Use with DEBUG_FLAGS and DEBUG_FILE</span>
<a name="l00320"></a>00320 <span class="comment">                                        environment variables.  See \ref SSMTRACE.</span>
<a name="l00321"></a>00321 <span class="comment">  --enable-dbgsymbols   default:no      Turn on debugger symbols</span>
<a name="l00322"></a>00322 <span class="comment">                                        Use this to override what a given</span>
<a name="l00323"></a>00323 <span class="comment">                                        debugging level will normally do.</span>
<a name="l00324"></a>00324 <span class="comment">  --enable-explicit     default:no      Compile with explicit templates</span>
<a name="l00325"></a>00325 <span class="comment">                                        NOT TESTED. </span>
<a name="l00326"></a>00326 <span class="comment"> \todo mainpage.h compile with or remove explicit templates</span>
<a name="l00327"></a>00327 <span class="comment"></span>
<a name="l00328"></a>00328 <span class="comment">  --enable-valgrind     default:no      Enable running valgrind run-time behavior</span>
<a name="l00329"></a>00329 <span class="comment">                                        Includes some code for valgrind.</span>
<a name="l00330"></a>00330 <span class="comment">  --enable-purify       default:no      Enable build of &lt;prog&gt;.pure</span>
<a name="l00331"></a>00331 <span class="comment">  --enable-quantify     default:no      Enable build of &lt;prog&gt;.quant</span>
<a name="l00332"></a>00332 <span class="comment">  --enable-purecov      default:no      Enable build of &lt;prog&gt;.purecov</span>
<a name="l00333"></a>00333 <span class="comment"></span>
<a name="l00334"></a>00334 <span class="comment">SHORE-specific Optional Packages:</span>
<a name="l00335"></a>00335 <span class="comment">  --with-page-size        1024, 2048, 4196, 8192(default), 16384, or 32768</span>
<a name="l00336"></a>00336 <span class="comment">  --with-hugetlbfs        Use the hugetlbfs for the buffer pool.</span>
<a name="l00337"></a>00337 <span class="comment">                          Depending on the target architecture, this might</span>
<a name="l00338"></a>00338 <span class="comment">                          be useful.  If you use it, you will need to set</span>
<a name="l00339"></a>00339 <span class="comment">                          a path for your hugetlbfs in config/shore.def.</span>
<a name="l00340"></a>00340 <span class="comment">                          The default is :</span>
<a name="l00341"></a>00341 <span class="comment">                          #define HUGETLBFS_PATH "/mnt/huge/SSM-BUFPOOL"</span>
<a name="l00342"></a>00342 <span class="comment">  --without-mmap          Do not use mmap for the buffer pool. Trumps</span>
<a name="l00343"></a>00343 <span class="comment">                          hugetlbfs option.</span>
<a name="l00344"></a>00344 <span class="comment">  --with-debug-level1     Include level 1 debug code, optimize.</span>
<a name="l00345"></a>00345 <span class="comment">                          This includes code in w_assert1 and </span>
<a name="l00346"></a>00346 <span class="comment">                          #if W_DEBUG_LEVEL &gt; 0 /#endif pairs and </span>
<a name="l00347"></a>00347 <span class="comment">                          #if W_DEBUG_LEVEL &gt;= 1 /#endif pairs and  and</span>
<a name="l00348"></a>00348 <span class="comment">                          W_IFDEBUG1</span>
<a name="l00349"></a>00349 <span class="comment">  --with-debug-level2     Include level 2 debug code, no optimize.</span>
<a name="l00350"></a>00350 <span class="comment">                          Equivalent to debug level 1 PLUS</span>
<a name="l00351"></a>00351 <span class="comment">                          code in w_assert2 and</span>
<a name="l00352"></a>00352 <span class="comment">                          #if W_DEBUG_LEVEL &gt; 1 /#endif pairs and</span>
<a name="l00353"></a>00353 <span class="comment">                          #if W_DEBUG_LEVEL &gt;= 2 /#endif pairs and</span>
<a name="l00354"></a>00354 <span class="comment">                          W_IFDEBUG2</span>
<a name="l00355"></a>00355 <span class="comment">  --with-debug-level3     Include level 3 debug code, no optimize.</span>
<a name="l00356"></a>00356 <span class="comment">                          Equivalent to debug level 2 PLUS</span>
<a name="l00357"></a>00357 <span class="comment">                          includes code in w_assert3  and</span>
<a name="l00358"></a>00358 <span class="comment">                          #if W_DEBUG_LEVEL &gt; 2 /#endif pairs and</span>
<a name="l00359"></a>00359 <span class="comment">                          #if W_DEBUG_LEVEL &gt;= 3 /#endif pairs and</span>
<a name="l00360"></a>00360 <span class="comment">                          W_IFDEBUG3</span>
<a name="l00361"></a>00361 <span class="comment"> \endverbatim</span>
<a name="l00362"></a>00362 <span class="comment"></span>
<a name="l00363"></a>00363 <span class="comment"> \bug GNATS 136 Only 64-bit platforms are supported. The issue is that</span>
<a name="l00364"></a>00364 <span class="comment"> lsns and some other data structures need atomic methods.</span>
<a name="l00365"></a>00365 <span class="comment"></span>
<a name="l00366"></a>00366 <span class="comment"> \bug GNATS 143 </span>
<a name="l00367"></a>00367 <span class="comment"> The polyphase merge-sort does not handle this case:</span>
<a name="l00368"></a>00368 <span class="comment"> More than one run is required AND </span>
<a name="l00369"></a>00369 <span class="comment"> keys are embedded in  objects AND the keys are </span>
<a name="l00370"></a>00370 <span class="comment"> already in lexicographic order in the</span>
<a name="l00371"></a>00371 <span class="comment"> object AND the keys are properly aligned AND the keys </span>
<a name="l00372"></a>00372 <span class="comment"> span multiple pages.</span>
<a name="l00373"></a>00373 <span class="comment"> It returns an error indication about a "broken key" comparison not </span>
<a name="l00374"></a>00374 <span class="comment"> being implemented. The workaround is to provide a marshal function</span>
<a name="l00375"></a>00375 <span class="comment"> or to put the sort key in the header of the object or to provide more</span>
<a name="l00376"></a>00376 <span class="comment"> memory (larger number of pages for the run size) for the sort.</span>
<a name="l00377"></a>00377 <span class="comment"> </span>
<a name="l00378"></a>00378 <span class="comment"></span>
<a name="l00379"></a>00379 <span class="comment"> \bug GNATS 139  Convert w_assert9 to w_assert3 where the asserts are still reasonable and remove the rest.  Some of these are obsolete, some are racy in the new mt-context.  All the w_assert9's are what used to be w_assert3; they were turned into 9 to disable them until they could be evaluated for usefulness, and many have been converted to 2 or 3-level asserts; many remain to be addressed.</span>
<a name="l00380"></a>00380 <span class="comment"></span>
<a name="l00381"></a>00381 <span class="comment"> * \subsection SHOREDEFOPT Description of Selected CPP Macros </span>
<a name="l00382"></a>00382 <span class="comment"> * In this section we describe selected macros defined (or not) in</span>
<a name="l00383"></a>00383 <span class="comment"> * \e config/shore.def.</span>
<a name="l00384"></a>00384 <span class="comment"> *</span>
<a name="l00385"></a>00385 <span class="comment"> * - HUGETLBFS_PATH See --with-hugetlbfs in \ref CONFIGOPT;</span>
<a name="l00386"></a>00386 <span class="comment"> *   see also \ref REFHUGEPAGE1 "Huge Pages" for use of hugetlbfs with Linux.</span>
<a name="l00387"></a>00387 <span class="comment"> *</span>
<a name="l00388"></a>00388 <span class="comment"> * - USE_SSMTEST Define this if you want to include crash test hooks in your</span>
<a name="l00389"></a>00389 <span class="comment"> *   smsh.  This is for a maintainer's testing purposes and should not be</span>
<a name="l00390"></a>00390 <span class="comment"> *   defined for a release version of the storage manager.</span>
<a name="l00391"></a>00391 <span class="comment"> *</span>
<a name="l00392"></a>00392 <span class="comment"> * - COMMON_GTID_LENGTH : You can override the default length of a global</span>
<a name="l00393"></a>00393 <span class="comment"> *   transaction id. </span>
<a name="l00394"></a>00394 <span class="comment"> *   Useful only if your server implements distributed </span>
<a name="l00395"></a>00395 <span class="comment"> *   transactions.</span>
<a name="l00396"></a>00396 <span class="comment"> *</span>
<a name="l00397"></a>00397 <span class="comment"> * - COMMON_SERVER_HANDLE_LENGTH : You can override the default length of a </span>
<a name="l00398"></a>00398 <span class="comment"> *   server handle, the handle by which the server identifies a</span>
<a name="l00399"></a>00399 <span class="comment"> *   coordinator of distributed transaction.</span>
<a name="l00400"></a>00400 <span class="comment"> *   Useful only if your server implements distributed </span>
<a name="l00401"></a>00401 <span class="comment"> *   transactions.</span>
<a name="l00402"></a>00402 <span class="comment"> *</span>
<a name="l00403"></a>00403 <span class="comment"> * - SM_LOG_PARTITIONS  : You can override the default maximum number of</span>
<a name="l00404"></a>00404 <span class="comment"> *   open partitions for the log by defining this. </span>
<a name="l00405"></a>00405 <span class="comment"> *</span>
<a name="l00406"></a>00406 <span class="comment"> * - SM_EXTENTSIZE  : You can override the default extent size with this.</span>
<a name="l00407"></a>00407 <span class="comment"> *   Warning: you must also address the alignment of Pmap_Align4</span>
<a name="l00408"></a>00408 <span class="comment"> *   based on the resulting size of a Pmap. See extent.h, logrec.h,</span>
<a name="l00409"></a>00409 <span class="comment"> *   pmap.h.</span>
<a name="l00410"></a>00410 <span class="comment"> *   Warning: this has never been tested. This information is included</span>
<a name="l00411"></a>00411 <span class="comment"> *   only for those whose hacking on the storage manager who may require larger</span>
<a name="l00412"></a>00412 <span class="comment"> *   extents.</span>
<a name="l00413"></a>00413 <span class="comment"> *</span>
<a name="l00414"></a>00414 <span class="comment"> *\subsection OPTTCL Tcl and smsh </span>
<a name="l00415"></a>00415 <span class="comment"> * The storage manager test shell, smsh, uses Tcl.</span>
<a name="l00416"></a>00416 <span class="comment"> * Autoconf tries to find Tcl in a standard place; if it is found,</span>
<a name="l00417"></a>00417 <span class="comment"> * fine. But if not, you must define two paths to your Tcl </span>
<a name="l00418"></a>00418 <span class="comment"> * library and include files in \e Makefile.local</span>
<a name="l00419"></a>00419 <span class="comment"> * at the top of the directory tree.  </span>
<a name="l00420"></a>00420 <span class="comment"> * If you Tcl installation is not built for multithreading, you must </span>
<a name="l00421"></a>00421 <span class="comment"> * install such a copy and put its path in \e Makefile.local.</span>
<a name="l00422"></a>00422 <span class="comment"> *</span>
<a name="l00423"></a>00423 <span class="comment"> * Tcl is available from </span>
<a name="l00424"></a>00424 <span class="comment"> * - ActiveState (http://www.activestate.com/activetcl/), or</span>
<a name="l00425"></a>00425 <span class="comment"> * - SourceForge (http://sourceforge.net/projects/tcl/files/).</span>
<a name="l00426"></a>00426 <span class="comment"> *</span>
<a name="l00427"></a>00427 <span class="comment"> *\section OPTBLD Building</span>
<a name="l00428"></a>00428 <span class="comment"> * Building the storage manager consist of running</span>
<a name="l00429"></a>00429 <span class="comment"> * \code</span>
<a name="l00430"></a>00430 <span class="comment"> make</span>
<a name="l00431"></a>00431 <span class="comment"> \endcode</span>
<a name="l00432"></a>00432 <span class="comment"> *</span>
<a name="l00433"></a>00433 <span class="comment"> * Since it is not alway easy to tell what options were used for the</span>
<a name="l00434"></a>00434 <span class="comment"> * most recent build in a directory, the compiler options used on the</span>
<a name="l00435"></a>00435 <span class="comment"> * build are put in the file \e makeflags </span>
<a name="l00436"></a>00436 <span class="comment"> * and the rest of the options are determined in \e config/shore-config.h,</span>
<a name="l00437"></a>00437 <span class="comment"> * produced at configuration time.</span>
<a name="l00438"></a>00438 <span class="comment"> *</span>
<a name="l00439"></a>00439 <span class="comment"> * \note For Solaris users: if you use CC rather than gcc,</span>
<a name="l00440"></a>00440 <span class="comment"> * you will probably have to run configure</span>
<a name="l00441"></a>00441 <span class="comment"> * with environment variable CXX defined as the path to your</span>
<a name="l00442"></a>00442 <span class="comment"> * CC compiler, and you might also need</span>
<a name="l00443"></a>00443 <span class="comment"> * \code configure --enable-dependency-tracking \endcode.</span>
<a name="l00444"></a>00444 <span class="comment"> *</span>
<a name="l00445"></a>00445 <span class="comment"> * \section SHOREMKCHECK Checking the Release</span>
<a name="l00446"></a>00446 <span class="comment"> *</span>
<a name="l00447"></a>00447 <span class="comment"> * After building the storage manager, you can check it by running</span>
<a name="l00448"></a>00448 <span class="comment"> * \code</span>
<a name="l00449"></a>00449 <span class="comment"> make check</span>
<a name="l00450"></a>00450 <span class="comment"> \endcode</span>
<a name="l00451"></a>00451 <span class="comment"> * in the root of the directory tree.</span>
<a name="l00452"></a>00452 <span class="comment"> * This runs unit tests for each libary.</span>
<a name="l00453"></a>00453 <span class="comment"> *</span>
<a name="l00454"></a>00454 <span class="comment"> * \attention</span>
<a name="l00455"></a>00455 <span class="comment"> * The storage manager test shell, smsh, is run by</span>
<a name="l00456"></a>00456 <span class="comment"> * \code make check \endcode.  Smsh uses Tcl.  The path to you</span>
<a name="l00457"></a>00457 <span class="comment"> * Tcl installation is given in \e Makefile.local  at the </span>
<a name="l00458"></a>00458 <span class="comment"> * top of the directory tree.</span>
<a name="l00459"></a>00459 <span class="comment"> *</span>
<a name="l00460"></a>00460 <span class="comment"> * \note</span>
<a name="l00461"></a>00461 <span class="comment"> * If you do not have Tcl installed and want to test the installation</span>
<a name="l00462"></a>00462 <span class="comment"> * without smsh, you may run</span>
<a name="l00463"></a>00463 <span class="comment"> * \e make \e check and ignore the fact that </span>
<a name="l00464"></a>00464 <span class="comment"> * it chokes trying to build smsh, because</span>
<a name="l00465"></a>00465 <span class="comment"> * smsh is the last test that \e make \e check runs.</span>
<a name="l00466"></a>00466 <span class="comment"> *</span>
<a name="l00467"></a>00467 <span class="comment"> * \section SHOREMKINSTALL Installing the Release</span>
<a name="l00468"></a>00468 <span class="comment"> *</span>
<a name="l00469"></a>00469 <span class="comment"> * You may run </span>
<a name="l00470"></a>00470 <span class="comment"> * \code</span>
<a name="l00471"></a>00471 <span class="comment"> make install</span>
<a name="l00472"></a>00472 <span class="comment"> \endcode</span>
<a name="l00473"></a>00473 <span class="comment"> * This installs:</span>
<a name="l00474"></a>00474 <span class="comment"> * - the header files  in </span>
<a name="l00475"></a>00475 <span class="comment"> *   - &lt;includedir&gt; [default: &lt;prefix&gt;/include]</span>
<a name="l00476"></a>00476 <span class="comment"> * - the libraries     in </span>
<a name="l00477"></a>00477 <span class="comment"> *   - &lt;libdir&gt; [default: &lt;exec-prefix&gt;/lib]</span>
<a name="l00478"></a>00478 <span class="comment"> *</span>
<a name="l00479"></a>00479 <span class="comment"> *  To change the prefixes, use one or more of these configure options:</span>
<a name="l00480"></a>00480 <span class="comment"> *  \code configure --prefix=&lt;path&gt; \endcode</span>
<a name="l00481"></a>00481 <span class="comment"> *  or</span>
<a name="l00482"></a>00482 <span class="comment"> *  \code configure --libdir=&lt;path&gt; \endcode</span>
<a name="l00483"></a>00483 <span class="comment"> *  or</span>
<a name="l00484"></a>00484 <span class="comment"> *  \code configure --includedir=&lt;path&gt; \endcode</span>
<a name="l00485"></a>00485 <span class="comment"> *</span>
<a name="l00486"></a>00486 <span class="comment"> */</span>
<a name="l00487"></a>00487 <span class="comment"></span>
<a name="l00488"></a>00488 <span class="comment">/**\cond skip */</span><span class="comment"></span>
<a name="l00489"></a>00489 <span class="comment">/**\page HUGETLBFS HugeTLBfs</span>
<a name="l00490"></a>00490 <span class="comment"> *</span>
<a name="l00491"></a>00491 <span class="comment"> * See \ref REFHUGEPAGE1 "Huge Pages" for assorted on-line documentation about</span>
<a name="l00492"></a>00492 <span class="comment"> * using large pages to avoid excessive load on the TLB.</span>
<a name="l00493"></a>00493 <span class="comment"> *</span>
<a name="l00494"></a>00494 <span class="comment"> * Here we do not claim to be complete for all target architectures.</span>
<a name="l00495"></a>00495 <span class="comment"> * This is meant to serve as an example for Linux targets.</span>
<a name="l00496"></a>00496 <span class="comment"> * The following steps are what we did on one RHEL5 system.</span>
<a name="l00497"></a>00497 <span class="comment"> *</span>
<a name="l00498"></a>00498 <span class="comment"> * NOTE: If you have kernel documentation installed, see:</span>
<a name="l00499"></a>00499 <span class="comment"> * /usr/share/doc/kernel-doc-&lt;version&gt;/Documentation/vm/hugetlbpage.txt</span>
<a name="l00500"></a>00500 <span class="comment"> *</span>
<a name="l00501"></a>00501 <span class="comment"> * First steps (most of this must be done by the super-user):</span>
<a name="l00502"></a>00502 <span class="comment"> * - Determine that our kernel supports hugetlbfs.</span>
<a name="l00503"></a>00503 <span class="comment"> *   - grep Hugepagesize /proc/meminfo</span>
<a name="l00504"></a>00504 <span class="comment"> * - Ensure that we have adequate huge pages (this example is</span>
<a name="l00505"></a>00505 <span class="comment"> *   for an 8GB buffer pool) on reboot:</span>
<a name="l00506"></a>00506 <span class="comment"> *   - echo "vm.nr_hugepages=4096" &gt;&gt; /etc/sysctl.conf</span>
<a name="l00507"></a>00507 <span class="comment"> *   To dynamically allocate pages, </span>
<a name="l00508"></a>00508 <span class="comment"> *   - echo 4096 &gt; /proc/sys/vm/nr_hugepages</span>
<a name="l00509"></a>00509 <span class="comment"> * - Create a group for users of the hugetlbfs using your sys admin</span>
<a name="l00510"></a>00510 <span class="comment"> *   applications. My group is called "ssm" and has gid 55555.</span>
<a name="l00511"></a>00511 <span class="comment"> * - Add users to the ssm group.</span>
<a name="l00512"></a>00512 <span class="comment"> * - Create the mount point for a hugetlbfs:</span>
<a name="l00513"></a>00513 <span class="comment"> *   - mkdir -p /mnt/huge</span>
<a name="l00514"></a>00514 <span class="comment"> * - Mount a pseudo filesystem of type hugetlbfs at that mount point; do this</span>
<a name="l00515"></a>00515 <span class="comment"> *   on reboot:</span>
<a name="l00516"></a>00516 <span class="comment"> *   - echo "none       /mnt/huge    hugetlbfs rw,gid=55555,size10g,mode=0770 0 0" &gt; /etc/fstab</span>
<a name="l00517"></a>00517 <span class="comment"> *</span>
<a name="l00518"></a>00518 <span class="comment"> * - Reboot.</span>
<a name="l00519"></a>00519 <span class="comment"> *</span>
<a name="l00520"></a>00520 <span class="comment"> *\warning </span>
<a name="l00521"></a>00521 <span class="comment"> * &lt;b&gt; If you have configured the storage manager for use with hugetlbfs</span>
<a name="l00522"></a>00522 <span class="comment"> * and have not taken the above steps to ensure that your system actually</span>
<a name="l00523"></a>00523 <span class="comment"> * has the hugetlbfs pages available for use, your storage manager (or</span>
<a name="l00524"></a>00524 <span class="comment"> * the 'make check' tests) will likely croak.  Unfortunately, we have</span>
<a name="l00525"></a>00525 <span class="comment"> * not yet figured out a way to determine ahead of time, programmatically,</span>
<a name="l00526"></a>00526 <span class="comment"> * whether things will go well or not, before we try to write to the </span>
<a name="l00527"></a>00527 <span class="comment"> * huge pages.  &lt;/b&gt;</span>
<a name="l00528"></a>00528 <span class="comment"> *</span>
<a name="l00529"></a>00529 <span class="comment"> *</span>
<a name="l00530"></a>00530 <span class="comment"> * Second steps (this can be done by users in the ssm group):</span>
<a name="l00531"></a>00531 <span class="comment"> * - Edit the default path for the hugetlbfs node in config/shore.def.</span>
<a name="l00532"></a>00532 <span class="comment"> * - Create a file in the hugetlbfs, owned by the ssm group, whose</span>
<a name="l00533"></a>00533 <span class="comment"> *   name matches the default path in config/shore.def, e.g.,</span>
<a name="l00534"></a>00534 <span class="comment"> *   - touch /etc/huge/SSM-BUFPOOL</span>
<a name="l00535"></a>00535 <span class="comment"> * - Configure and build the storage manager with --with-hugetlbfs.</span>
<a name="l00536"></a>00536 <span class="comment"> * - To run using the hugetlbfs is now the default; to run without it,</span>
<a name="l00537"></a>00537 <span class="comment"> *   change the sm_hugetlbfs_path run-time option to the value "NULL"; </span>
<a name="l00538"></a>00538 <span class="comment"> *   here is an example from the .shoreconfig file in the smsh directory:</span>
<a name="l00539"></a>00539 <span class="comment"> *   - *.server.*.sm_hugetlbfs_path: NULL</span>
<a name="l00540"></a>00540 <span class="comment"> *</span>
<a name="l00541"></a>00541 <span class="comment"> *   Note that your buffer pool size will have to be set to a multiple</span>
<a name="l00542"></a>00542 <span class="comment"> *   of the huge page size for your system.  Thus, if your huge pages are 2 MB</span>
<a name="l00543"></a>00543 <span class="comment"> *   you will get an error from mmap if you use a 3 MB buffer pool.</span>
<a name="l00544"></a>00544 <span class="comment"> *</span>
<a name="l00545"></a>00545 <span class="comment"> *   On the whole, the use of mmap with the hugetlbfs is not reliable</span>
<a name="l00546"></a>00546 <span class="comment"> *   and, although at process end, all huge pages are supposed to be returned</span>
<a name="l00547"></a>00547 <span class="comment"> *   to the system, we have seen cases in which pages were "lost" and</span>
<a name="l00548"></a>00548 <span class="comment"> *   the mmap thereafter failing, repaired only on reboot, so consider this</span>
<a name="l00549"></a>00549 <span class="comment"> *   feature for performance experiments only on systems that do not</span>
<a name="l00550"></a>00550 <span class="comment"> *   require high availability. </span>
<a name="l00551"></a>00551 <span class="comment"> *</span>
<a name="l00552"></a>00552 <span class="comment"> */</span><span class="comment"></span>
<a name="l00553"></a>00553 <span class="comment">/**\endcond skip */</span>
<a name="l00554"></a>00554 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Jan 2 15:13:57 2012 for Shore Storage Manager by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
