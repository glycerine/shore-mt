<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Shore Storage Manager: Running Out of Log Space</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="../../modules.html"><span>Modules</span></a></li>
    <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="../../classes.html"><span>Classes</span></a></li>
    <li><a href="../../files.html"><span>Files</span></a></li>
    <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="../../examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1>Running Out of Log Space<br>
<small>
[<a class="el" href="../../d8/d1e/group___s_s_m_x_c_t.html">Transactions, Locking and Logging</a>]</small>
</h1>
<p>
Collaboration diagram for Running Out of Log Space:<center><table><tr><td><img src="../../df/d2d/group___l_o_g_s_p_a_c_e.png" border="0" alt="" usemap="#d5/d99/df_2d2d_2group______l__o__g__s__p__a__c__e_map">
<map name="d5/d99/df_2d2d_2group______l__o__g__s__p__a__c__e_map">
<area href="../../d8/d1e/group___s_s_m_x_c_t.html" shape="rect" coords="5,5,245,32" alt="">
</map></td></tr></table></center>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Updates performed by transactions are logged so that the can be rolled back (in the event of a transaction abort) or restored (in the event of a crash). Both the old and new values of an updated location are logged. This allows a steal, no-force buffer management policy, which means the buffer manager is free to write dirty pages to disk at any time and yet does not have to write dirty pages for a a transaction to commit.<p>
The log is stored in a set of Unix files, all in the same directory, whose path is determined by a run-time option. The maximum size of the log is also determined by a run-time option.o The proper value of the log size depends on the expected transaction mix. More specifically, it depends on the age of the oldest (longest running) transaction in the system and the amount of log space used by all active transactions. Here are some general rules to determine the amount of free log space available in the system.<ul>
<li>Log records between the first log record generated by the oldest active transaction and the most recent log record generated by any transaction cannot be thrown away.</li><li>Log records from a transaction are no longer needed once the transaction has committed or completely aborted and all updates have made it to disk. Aborting a transaction causes log space to be used, so space is reserved for aborting each transaction. Enough log space must be available to commit or abort all active transactions at all times.</li></ul>
<p>
<ul>
<li>Only space starting at the beginning of the log can be reused. This space can be reused if it contains log records only for transactions meeting the previous rule.</li></ul>
<p>
<ul>
<li>All storage manager calls that update records require log space twice the size of the space updated in the record. All calls that create, append, or truncate records require log space equal to the size created, inserted, or deleted. Log records generated by these calls (generally one per call) have an overhead of approximately 50 bytes.</li></ul>
<p>
<ul>
<li>The amount of log space reserved for aborting a transaction is equal to the amount of log space generated by the transaction plus a fudge factor. (Where btrees are concerned, a structure modification might be necessary on abort, using more space on abort, or might not be necessary on abort where it was done during forward processing, using less space on abort.)</li></ul>
<p>
<ul>
<li>The transaction assumes responsiblity for reserving space in the log so that it can abort, should it need to (without leaving an unrecoverable volume). The transaction and the log cooperate to reserve space for the transaction's aborting.</li></ul>
<p>
<ul>
<li>When insufficient log space is available for a transaction, the transaction is (may be, depending on the server) aborted. The storage manager will return an error indication (out of log space) if it is unable to insert a log record into the log due to insufficient space.</li></ul>
<p>
Checkpoints are taken periodically by the storage manager in order to free log space and shorten recovery time. Checkpoints are "fuzzy" and can do not require the system to pause while they are completing.<p>
See the storage manager constructor <a class="el" href="../../de/db0/group___s_s_m_i_n_i_t.html#g4b4479aa4533cf55b6baccc3758d08b2">ss_m::ss_m</a> for more information about handling out-of-logspace conditions. 
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d32/classxct__t.html">xct_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A transaction. Internal to the storage manager.<p>
This class may be used in a limited way for the handling of out-of-log-space conditions. See <a class="el" href="../../df/d2d/group___l_o_g_s_p_a_c_e.html">Running Out of Log Space</a>.  <a href="../../df/d32/classxct__t.html#_details">More...</a><br></td></tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jan 2 15:14:01 2012 for Shore Storage Manager by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
