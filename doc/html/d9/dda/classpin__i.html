<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Shore Storage Manager: pin_i Class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="../../modules.html"><span>Modules</span></a></li>
    <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="../../classes.html"><span>Classes</span></a></li>
    <li><a href="../../files.html"><span>Files</span></a></li>
    <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="../../examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="../../classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="../../annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="../../hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="../../functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>pin_i Class Reference<br>
<small>
[<a class="el" href="../../d6/dfa/group___s_s_m_p_i_n.html">Pinning Records</a>]</small>
</h1><!-- doxytag: class="pin_i" --><!-- doxytag: inherits="smlevel_top" -->Inherits smlevel_top.
<p>
Collaboration diagram for pin_i:<p><center><img src="../../d3/d28/classpin__i__coll__graph.png" border="0" usemap="#dc/dae/pin__i__coll__map" alt="Collaboration graph"></center>
<map name="dc/dae/pin__i__coll__map">
<area href="../../d2/d19/classlsn__t.html" shape="rect" coords="121,399,172,425" alt="">
<area href="../../d7/df5/classrid__t.html" shape="rect" coords="250,399,299,425" alt="">
<area href="../../d5/d47/classlpid__t.html" shape="rect" coords="173,299,227,325" alt="">
<area href="../../da/d5b/structstid__t.html" shape="rect" coords="170,200,224,227" alt="">
<area href="../../d8/d90/classw__hashing_1_1hash2.html" shape="rect" coords="5,109,144,136" alt="">
<area href="../../dc/d6c/classw__hashing_1_1uhash.html" shape="rect" coords="5,5,144,32" alt="">
<area href="../../d1/d4b/structfill2.html" shape="rect" coords="291,109,335,136" alt="">
<area href="../../d3/d3f/structvid__t.html" shape="rect" coords="169,109,220,136" alt="">
</map>
<center><font size="2">[<a target="top" href="../../graph_legend.html">legend</a>]</font></center><a href="../../de/da1/classpin__i-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Pin records in the buffer pool and operate on them. 
<p>
Certain operations on the records referenced by a <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a> may invalidate the <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a>. For example, if you pin a record, then truncate it or append to it while holding a <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a>, the <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a> must be considered invalidated because appending to the record might necessarily require moving it.<p>
The pin functions take a lock mode parameter that tells the storage manager how to lock the record initially. The options are SH and EX. EX should be used when the pinned record will be updated (through update_rec, unpdate_rec_hdr, append_rec, or truncate_rec). Using EX in these cases will improve performance and reduce the risk of deadlock, but it is not necessary for correctness.<p>
If you pin with SH, and subsequently modify the record through <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a>, the <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a> method(s) will upgrade locks as necessary to maintain ACID properties.<p>
These methods will not perform needless unfix/refix operations: you may pin many small records on the same page in sequence and avoid unfixing the page between pins. <dl compact><dt><b>Examples: </b></dt><dd>

<p>
<a class="el" href="../../df/d97/create__rec_8cpp-example.html#_a37">create_rec.cpp</a>, and <a class="el" href="../../d6/d97/sort__stream_8cpp-example.html#_a137">sort_stream.cpp</a>.</dl>
<p>

<p>
Definition at line <a class="el" href="../../d5/dc1/pin_8h-source.html#l00184">184</a> of file <a class="el" href="../../d5/dc1/pin_8h-source.html">pin.h</a>.<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9799da42091d6a569124981fb9bf1f97"></a><!-- doxytag: member="pin_i::pin_i" ref="9799da42091d6a569124981fb9bf1f97" args="()" -->
NORET&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#9799da42091d6a569124981fb9bf1f97">pin_i</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor. Does not pin anything until <a class="el" href="../../d9/dda/classpin__i.html#020be0f4e108575b28afb4ab6fed0461">pin()</a> is called. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7489b5e65137c8b6ecd9ca774fb9827b"></a><!-- doxytag: member="pin_i::~pin_i" ref="7489b5e65137c8b6ecd9ca774fb9827b" args="()" -->
NORET&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#7489b5e65137c8b6ecd9ca774fb9827b">~pin_i</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor. Unpins anything currently pinned. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#020be0f4e108575b28afb4ab6fed0461">pin</a> (const <a class="el" href="../../d7/df5/classrid__t.html">rid_t</a> &amp;rid, smsize_t start, lock_mode_t lmode=SH)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pin a portion of the record starting at a given location.  <a href="#020be0f4e108575b28afb4ab6fed0461"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#e7577fa49394bcb4ad5ce404e67070ba">pin</a> (const <a class="el" href="../../d7/df5/classrid__t.html">rid_t</a> &amp;rid, smsize_t start, lock_mode_t lock_mode, latch_mode_t latch_mode)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pin a portion of the record starting at a given location.  <a href="#e7577fa49394bcb4ad5ce404e67070ba"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ca996f286e8c0f757ef20134de968ab0"></a><!-- doxytag: member="pin_i::unpin" ref="ca996f286e8c0f757ef20134de968ab0" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#ca996f286e8c0f757ef20134de968ab0">unpin</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unpin whatever record was pinned. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2811ccc83de99a9aeb95dcb3df20942f"></a><!-- doxytag: member="pin_i::is_mine" ref="2811ccc83de99a9aeb95dcb3df20942f" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#2811ccc83de99a9aeb95dcb3df20942f">is_mine</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if the running thread owns this <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a>. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#06a585817c9966e6465b669f88d56518">set_ref_bit</a> (int value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the reference bit to use for the buffer frame containing the pinned body page when the page is unpinned.  <a href="#06a585817c9966e6465b669f88d56518"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#64b4698bdd5eabc0af6db57a9c1c2d74">repin</a> (lock_mode_t lmode=SH)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Efficiently repin a record after is size has changed or after it has been unpinned.  <a href="#64b4698bdd5eabc0af6db57a9c1c2d74"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#d122d5d2a6612ffe33f1d82e5c38e166">next_bytes</a> (bool &amp;eof)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pin the next range of bytes in the record.  <a href="#d122d5d2a6612ffe33f1d82e5c38e166"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="848c54a3154ae22239e9e153f1ba61cb"></a><!-- doxytag: member="pin_i::pinned" ref="848c54a3154ae22239e9e153f1ba61cb" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#848c54a3154ae22239e9e153f1ba61cb">pinned</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if something currently pinned. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7ed3bfee3fb97bd4e629d0fd17c34c03"></a><!-- doxytag: member="pin_i::pinned_all" ref="7ed3bfee3fb97bd4e629d0fd17c34c03" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#7ed3bfee3fb97bd4e629d0fd17c34c03">pinned_all</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if the entire record pinned. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#8089d91389b48157492f8140697a7bbc">up_to_date</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if record is pinned and the <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a> is valid.  <a href="#8089d91389b48157492f8140697a7bbc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d883db9da50bc1d8090cc1a5bfaeb83e"></a><!-- doxytag: member="pin_i::start_byte" ref="d883db9da50bc1d8090cc1a5bfaeb83e" args="() const " -->
smsize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#d883db9da50bc1d8090cc1a5bfaeb83e">start_byte</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the byte-offset (within the record) the of the pinned portion. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6c3763719e1e2bc5d810786edee81b16"></a><!-- doxytag: member="pin_i::length" ref="6c3763719e1e2bc5d810786edee81b16" args="() const " -->
smsize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#6c3763719e1e2bc5d810786edee81b16">length</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the length of the pinned portion. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="41221b345b30ac9c6a30f0ec84f0777c"></a><!-- doxytag: member="pin_i::hdr_size" ref="41221b345b30ac9c6a30f0ec84f0777c" args="() const " -->
smsize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#41221b345b30ac9c6a30f0ec84f0777c">hdr_size</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the size of the pinned record's header. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ab409305b17e7427916bc0f3f9fa7b8b"></a><!-- doxytag: member="pin_i::body_size" ref="ab409305b17e7427916bc0f3f9fa7b8b" args="() const " -->
smsize_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#ab409305b17e7427916bc0f3f9fa7b8b">body_size</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the size of the pinned record's body. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2036b0cd8906ea13f07869d11f56716a"></a><!-- doxytag: member="pin_i::is_large" ref="2036b0cd8906ea13f07869d11f56716a" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#2036b0cd8906ea13f07869d11f56716a">is_large</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if the record is too large to fit on a file page. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="92863a44fc3c4cafd2d686dc2e94166d"></a><!-- doxytag: member="pin_i::is_small" ref="92863a44fc3c4cafd2d686dc2e94166d" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#92863a44fc3c4cafd2d686dc2e94166d">is_small</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">True if the record is small enough to fit on a file page. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#eb15c28e27d706141b1e0f5f3222af27">large_impl</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The kind of large-record implementation used for the pinned record.  <a href="#eb15c28e27d706141b1e0f5f3222af27"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f419f7749c479328d383da92c547621c"></a><!-- doxytag: member="pin_i::rid" ref="f419f7749c479328d383da92c547621c" args="() const " -->
const <a class="el" href="../../d7/df5/classrid__t.html">rid_t</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#f419f7749c479328d383da92c547621c">rid</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the record ID of the pinned record. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#deaa7b659b50501bdf3aa0d49aa4284c">hdr</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a pointer to the pinned record's header in the buffer pool.  <a href="#deaa7b659b50501bdf3aa0d49aa4284c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#b63af4ebb3362d606219ab0b9d4b5794">body</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a pointer into the pinned-record-portion in the buffer pool.  <a href="#b63af4ebb3362d606219ab0b9d4b5794"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#4b32aa30d1e16fa1e902049700db879d">update_rec</a> (smsize_t start, const <a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;data, int *old_value=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Overwrite a portion of the pinned record with new data.  <a href="#4b32aa30d1e16fa1e902049700db879d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#6f54a8303250f80e77db58bc98a79244">update_rec_hdr</a> (smsize_t start, const <a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;hdr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the pinned record's header.  <a href="#6f54a8303250f80e77db58bc98a79244"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#90fc843fe0d1103d546218b7200db0e4">append_rec</a> (const <a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Append to a pinned record.  <a href="#90fc843fe0d1103d546218b7200db0e4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#d3492eec4af68d2dff0797d7a4ca1073">truncate_rec</a> (smsize_t amount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Shorten a record.  <a href="#d3492eec4af68d2dff0797d7a4ca1073"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f8bbc95f84ef28c4f7fa266ddfdab2e8"></a><!-- doxytag: member="pin_i::rec" ref="f8bbc95f84ef28c4f7fa266ddfdab2e8" args="() const " -->
const record_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#f8bbc95f84ef28c4f7fa266ddfdab2e8">rec</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#769939ad81f0cb1c6fb0fa4ecb900a2a">hdr_page_data</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a pointer to the page containing the record.  <a href="#769939ad81f0cb1c6fb0fa4ecb900a2a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d5/d47/classlpid__t.html">lpid_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dda/classpin__i.html#5211a99e127bf7aa80476eb8aa5fc54e">page_containing</a> (smsize_t offset, smsize_t &amp;start_byte) const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the ID of the page containing the given byte of the record.  <a href="#5211a99e127bf7aa80476eb8aa5fc54e"></a><br></td></tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="020be0f4e108575b28afb4ab6fed0461"></a><!-- doxytag: member="pin_i::pin" ref="020be0f4e108575b28afb4ab6fed0461" args="(const rid_t &amp;rid, smsize_t start, lock_mode_t lmode=SH)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> pin_i::pin           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/df5/classrid__t.html">rid_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>rid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">smsize_t&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lock_mode_t&nbsp;</td>
          <td class="paramname"> <em>lmode</em> = <code>SH</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pin a portion of the record starting at a given location. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>rid</em>&nbsp;</td><td>ID of the record of interest </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>start</em>&nbsp;</td><td>Offset of the first byte of interest. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lmode</em>&nbsp;</td><td>Lock mode to use. Pin the page containing the first byte of interest. A record lock in the given mode is acquired (if it is not already subsumed by a coarser lock or by a higher lock mode).</td></tr>
  </table>
</dl>
Only the slotted page containing the record header is fixed at this point. Its latch mode is inferred from the lock mode. If any part of the record is pinned, the slotted page containing the header is also fixed. Thus, if the record is large (or very large), data pages won't be fixed in the buffer pool until the <a class="el" href="../../d9/dda/classpin__i.html#b63af4ebb3362d606219ab0b9d4b5794">body()</a> method is called. 
</div>
</div><p>
<a class="anchor" name="e7577fa49394bcb4ad5ce404e67070ba"></a><!-- doxytag: member="pin_i::pin" ref="e7577fa49394bcb4ad5ce404e67070ba" args="(const rid_t &amp;rid, smsize_t start, lock_mode_t lock_mode, latch_mode_t latch_mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> pin_i::pin           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/df5/classrid__t.html">rid_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>rid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">smsize_t&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">lock_mode_t&nbsp;</td>
          <td class="paramname"> <em>lock_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">latch_mode_t&nbsp;</td>
          <td class="paramname"> <em>latch_mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pin a portion of the record starting at a given location. 
<p>
Pin a record with the given lock mode and latch mode. See pin(rid, start, lock_mode); 
</div>
</div><p>
<a class="anchor" name="06a585817c9966e6465b669f88d56518"></a><!-- doxytag: member="pin_i::set_ref_bit" ref="06a585817c9966e6465b669f88d56518" args="(int value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pin_i::set_ref_bit           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>value</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the reference bit to use for the buffer frame containing the pinned body page when the page is unpinned. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>value</em>&nbsp;</td><td>0 or greater. A value of 0 is a "hate" hint indicating that the frame can be reused as soon as necessary. By default, a value of 1 is used indicating the page will be cached until at least 1 sweep of the buffer clock hand has passed. Higher values cause the page to remain cached longer. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="64b4698bdd5eabc0af6db57a9c1c2d74"></a><!-- doxytag: member="pin_i::repin" ref="64b4698bdd5eabc0af6db57a9c1c2d74" args="(lock_mode_t lmode=SH)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> pin_i::repin           </td>
          <td>(</td>
          <td class="paramtype">lock_mode_t&nbsp;</td>
          <td class="paramname"> <em>lmode</em> = <code>SH</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Efficiently repin a record after is size has changed or after it has been unpinned. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lmode</em>&nbsp;</td><td>SH or EX </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="d122d5d2a6612ffe33f1d82e5c38e166"></a><!-- doxytag: member="pin_i::next_bytes" ref="d122d5d2a6612ffe33f1d82e5c38e166" args="(bool &amp;eof)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> pin_i::next_bytes           </td>
          <td>(</td>
          <td class="paramtype">bool &amp;&nbsp;</td>
          <td class="paramname"> <em>eof</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Pin the next range of bytes in the record. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>eof</em>&nbsp;</td><td>Set to true if there are no more bytes to pin. When eof is reached, the previously pinned range remains pinned. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="8089d91389b48157492f8140697a7bbc"></a><!-- doxytag: member="pin_i::up_to_date" ref="8089d91389b48157492f8140697a7bbc" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool pin_i::up_to_date           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
True if record is pinned and the <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a> is valid. 
<p>
The <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a> is valid if it is up-to-date with the LSN on the page. In other words, use this to verify that the page has not been updated since it was pinned by this <a class="el" href="../../d9/dda/classpin__i.html">pin_i</a> 
<p>
Definition at line <a class="el" href="../../d5/dc1/pin_8h-source.html#l00289">289</a> of file <a class="el" href="../../d5/dc1/pin_8h-source.html">pin.h</a>.
<p>
References <a class="el" href="../../d9/dda/classpin__i.html#848c54a3154ae22239e9e153f1ba61cb">pinned()</a>.
<p>
Here is the call graph for this function:<p><center><img src="../../d9/dda/classpin__i_8089d91389b48157492f8140697a7bbc_cgraph.png" border="0" usemap="#d9/dda/classpin__i_8089d91389b48157492f8140697a7bbc_cgraph_map" alt=""></center>
<map name="d9/dda/classpin__i_8089d91389b48157492f8140697a7bbc_cgraph_map">
<area href="../../d9/dda/classpin__i.html#848c54a3154ae22239e9e153f1ba61cb" shape="rect" coords="184,5,288,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="eb15c28e27d706141b1e0f5f3222af27"></a><!-- doxytag: member="pin_i::large_impl" ref="eb15c28e27d706141b1e0f5f3222af27" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pin_i::large_impl           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The kind of large-record implementation used for the pinned record. 
<p>
Values returned are: 0, 1, or 2.<ul>
<li>0 means "large" : ~8KB - ~21 GB</li><li>1 means "1-level index" - up to ~16.GB</li><li>2 means "2-level index" - up to ~33 GB</li><li>3-level and deeper indexes are not supported. </li></ul>

<p>
Definition at line <a class="el" href="../../d5/dc1/pin_8h-source.html#l00313">313</a> of file <a class="el" href="../../d5/dc1/pin_8h-source.html">pin.h</a>.
</div>
</div><p>
<a class="anchor" name="deaa7b659b50501bdf3aa0d49aa4284c"></a><!-- doxytag: member="pin_i::hdr" ref="deaa7b659b50501bdf3aa0d49aa4284c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* pin_i::hdr           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a pointer to the pinned record's header in the buffer pool. 
<p>
<dl compact><dt><b>Attention:</b></dt><dd>Do NOT update anything directly in the buffer pool. This returns a const string because it is for the purpose of reading or copy-out. </dd></dl>

<p>
Definition at line <a class="el" href="../../d5/dc1/pin_8h-source.html#l00324">324</a> of file <a class="el" href="../../d5/dc1/pin_8h-source.html">pin.h</a>.
<p>
References <a class="el" href="../../d9/dda/classpin__i.html#848c54a3154ae22239e9e153f1ba61cb">pinned()</a>.
<p>
Here is the call graph for this function:<p><center><img src="../../d9/dda/classpin__i_deaa7b659b50501bdf3aa0d49aa4284c_cgraph.png" border="0" usemap="#d9/dda/classpin__i_deaa7b659b50501bdf3aa0d49aa4284c_cgraph_map" alt=""></center>
<map name="d9/dda/classpin__i_deaa7b659b50501bdf3aa0d49aa4284c_cgraph_map">
<area href="../../d9/dda/classpin__i.html#848c54a3154ae22239e9e153f1ba61cb" shape="rect" coords="136,5,240,32" alt="">
</map>

</div>
</div><p>
<a class="anchor" name="b63af4ebb3362d606219ab0b9d4b5794"></a><!-- doxytag: member="pin_i::body" ref="b63af4ebb3362d606219ab0b9d4b5794" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* pin_i::body           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a pointer into the pinned-record-portion in the buffer pool. 
<p>
<dl compact><dt><b>Attention:</b></dt><dd>Do NOT update anything directly in the buffer pool. This returns a const string because it is for the purpose of reading or copy-out. </dd></dl>

</div>
</div><p>
<a class="anchor" name="4b32aa30d1e16fa1e902049700db879d"></a><!-- doxytag: member="pin_i::update_rec" ref="4b32aa30d1e16fa1e902049700db879d" args="(smsize_t start, const vec_t &amp;data, int *old_value=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> pin_i::update_rec           </td>
          <td>(</td>
          <td class="paramtype">smsize_t&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>old_value</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Overwrite a portion of the pinned record with new data. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>start</em>&nbsp;</td><td>The offset from the beginning of the record of the place to perform the update. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>A vector containing the data to place in the record at location <em>start</em>. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>old_value</em>&nbsp;</td><td>deprecated The portion of the record containing the start byte need not be pinned before this is called. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="6f54a8303250f80e77db58bc98a79244"></a><!-- doxytag: member="pin_i::update_rec_hdr" ref="6f54a8303250f80e77db58bc98a79244" args="(smsize_t start, const vec_t &amp;hdr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> pin_i::update_rec_hdr           </td>
          <td>(</td>
          <td class="paramtype">smsize_t&nbsp;</td>
          <td class="paramname"> <em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>hdr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the pinned record's header. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>start</em>&nbsp;</td><td>The offset from the beginning of the header of the place to perform the update. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hdr</em>&nbsp;</td><td>A vector containing the data to place in the header at location <em>start</em>. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="90fc843fe0d1103d546218b7200db0e4"></a><!-- doxytag: member="pin_i::append_rec" ref="90fc843fe0d1103d546218b7200db0e4" args="(const vec_t &amp;data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> pin_i::append_rec           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>data</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Append to a pinned record. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>A vector containing the data to append to the record's body. The end of the record need not be pinned before this is called. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="d3492eec4af68d2dff0797d7a4ca1073"></a><!-- doxytag: member="pin_i::truncate_rec" ref="d3492eec4af68d2dff0797d7a4ca1073" args="(smsize_t amount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> pin_i::truncate_rec           </td>
          <td>(</td>
          <td class="paramtype">smsize_t&nbsp;</td>
          <td class="paramname"> <em>amount</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Shorten a record. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>amount</em>&nbsp;</td><td>Number of bytes to chop off the end of the pinned record's body. The end of the record need not be pinned before this is called. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="769939ad81f0cb1c6fb0fa4ecb900a2a"></a><!-- doxytag: member="pin_i::hdr_page_data" ref="769939ad81f0cb1c6fb0fa4ecb900a2a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* pin_i::hdr_page_data           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a pointer to the page containing the record. 
<p>
This allows you to read the entire page. <dl compact><dt><b>Attention:</b></dt><dd>Do NOT update anything directly in the buffer pool. This returns a const string because it is for the purpose of reading or copy-out. </dd></dl>

</div>
</div><p>
<a class="anchor" name="5211a99e127bf7aa80476eb8aa5fc54e"></a><!-- doxytag: member="pin_i::page_containing" ref="5211a99e127bf7aa80476eb8aa5fc54e" args="(smsize_t offset, smsize_t &amp;start_byte) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/d47/classlpid__t.html">lpid_t</a> pin_i::page_containing           </td>
          <td>(</td>
          <td class="paramtype">smsize_t&nbsp;</td>
          <td class="paramname"> <em>offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">smsize_t &amp;&nbsp;</td>
          <td class="paramname"> <em>start_byte</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return the ID of the page containing the given byte of the record. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>offset</em>&nbsp;</td><td>The offset from the beginning of the record of the byte of interest </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>start_byte</em>&nbsp;</td><td>The offset from the beginning of the page of the byte of interest </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>The page ID of the page containing the byte of interest. </dd></dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>src/sm/<a class="el" href="../../d5/dc1/pin_8h-source.html">pin.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jan 2 15:14:11 2012 for Shore Storage Manager by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
