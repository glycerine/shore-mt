<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Shore Storage Manager: sort_stream_i Class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="../../modules.html"><span>Modules</span></a></li>
    <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="../../classes.html"><span>Classes</span></a></li>
    <li><a href="../../files.html"><span>Files</span></a></li>
    <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="../../examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="../../classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="../../annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="../../hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="../../functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>sort_stream_i Class Reference<br>
<small>
[<a class="el" href="../../d4/de8/group___s_s_m_s_o_r_t.html">Sorting</a>]</small>
</h1><!-- doxytag: class="sort_stream_i" --><!-- doxytag: inherits="smlevel_top,xct_dependent_t" -->Inherits smlevel_top, and xct_dependent_t.
<p>
Collaboration diagram for sort_stream_i:<p><center><img src="../../d2/d87/classsort__stream__i__coll__graph.png" border="0" usemap="#d2/dd8/sort__stream__i__coll__map" alt="Collaboration graph"></center>
<map name="d2/dd8/sort__stream__i__coll__map">
<area href="../../d1/dbb/structssm__sort_1_1key__info__t.html" shape="rect" coords="5,187,159,213" alt="">
<area href="../../d2/dd1/classnbox__t.html" shape="rect" coords="51,96,115,123" alt="">
<area href="../../dc/db1/structfill4.html" shape="rect" coords="61,5,104,32" alt="">
<area href="../../db/d66/structssm__sort_1_1sort__parm__t.html" shape="rect" coords="184,187,348,213" alt="">
<area href="../../d3/d3f/structvid__t.html" shape="rect" coords="241,96,292,123" alt="">
</map>
<center><font size="2">[<a target="top" href="../../graph_legend.html">legend</a>]</font></center><a href="../../d4/de3/classsort__stream__i-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Sorting tool. 
<p>
Used for bulk-loading indexes but may be used independently. After creating an instance of <a class="el" href="../../da/d1c/classsort__stream__i.html">sort_stream_i</a>, you can keep putting &lt;key,element&gt; pairs into the stream, which will save the records in a temporary persistent store, sort them, and then return them in sorted order like an iterator over the temporary store. The temporary store is destroyed upon completion (destruction).<p>
Before you can begin inserting pairs into the stream, you must initialize the stream with information about the key on which to sort (where it is to be found, what its length and type are, etc.).<p>
See example sort_stream::cpp <dl compact><dt><b>Examples: </b></dt><dd>

<p>
<a class="el" href="../../d6/d97/sort__stream_8cpp-example.html#_a133">sort_stream.cpp</a>.</dl>
<p>

<p>
Definition at line <a class="el" href="../../d5/d96/sort_8h-source.html#l00434">434</a> of file <a class="el" href="../../d5/d96/sort_8h-source.html">sort.h</a>.<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="99fd7548f2e7cc626844c99804ac91f0"></a><!-- doxytag: member="sort_stream_i::sort_stream_i" ref="99fd7548f2e7cc626844c99804ac91f0" args="()" -->
NORET&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1c/classsort__stream__i.html#99fd7548f2e7cc626844c99804ac91f0">sort_stream_i</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor. If you use this constructor you must use <a class="el" href="../../da/d1c/classsort__stream__i.html#5a9882fa322ec456f0e44720dfc5ec27">init()</a>. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">NORET&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1c/classsort__stream__i.html#7af2cc223299f447fe3a01a54f17b5ae">sort_stream_i</a> (const <a class="el" href="../../d1/dbb/structssm__sort_1_1key__info__t.html">key_info_t</a> &amp;k, const <a class="el" href="../../db/d66/structssm__sort_1_1sort__parm__t.html">sort_parm_t</a> &amp;s, uint est_rec_sz=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor that calls <a class="el" href="../../da/d1c/classsort__stream__i.html#5a9882fa322ec456f0e44720dfc5ec27">init()</a>.  <a href="#7af2cc223299f447fe3a01a54f17b5ae"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1c/classsort__stream__i.html#5a9882fa322ec456f0e44720dfc5ec27">init</a> (const <a class="el" href="../../d1/dbb/structssm__sort_1_1key__info__t.html">key_info_t</a> &amp;k, const <a class="el" href="../../db/d66/structssm__sort_1_1sort__parm__t.html">sort_parm_t</a> &amp;s, uint est_rec_sz=0)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the stream with necessary metadata.  <a href="#5a9882fa322ec456f0e44720dfc5ec27"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="182e582de249ab9f0379b05c8457bd85"></a><!-- doxytag: member="sort_stream_i::finish" ref="182e582de249ab9f0379b05c8457bd85" args="()" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1c/classsort__stream__i.html#182e582de249ab9f0379b05c8457bd85">finish</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release resources, render unusable. (Called by destructor if apropos.). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1c/classsort__stream__i.html#f248b78ad8e2636783f3ba44f3d83bde">put</a> (const <a class="el" href="../../d9/da4/classcvec__t.html">cvec_t</a> &amp;key, const <a class="el" href="../../d9/da4/classcvec__t.html">cvec_t</a> &amp;elem)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Insert a key,elem pair into the stream.  <a href="#f248b78ad8e2636783f3ba44f3d83bde"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1c/classsort__stream__i.html#912549730adfcf5235ef72ac37bf9d95">get_next</a> (<a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;key, <a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;elem, bool &amp;eof)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Fetch the next key,elem pair from the stream (in sorted order).  <a href="#912549730adfcf5235ef72ac37bf9d95"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dc5c2dd06a04b2b0dec9a19d4a8d1975"></a><!-- doxytag: member="sort_stream_i::is_empty" ref="dc5c2dd06a04b2b0dec9a19d4a8d1975" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1c/classsort__stream__i.html#dc5c2dd06a04b2b0dec9a19d4a8d1975">is_empty</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns true until the first <a class="el" href="../../da/d1c/classsort__stream__i.html#f248b78ad8e2636783f3ba44f3d83bde">put()</a> call. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="903962d0397d3e190885a2c83c209a84"></a><!-- doxytag: member="sort_stream_i::is_sorted" ref="903962d0397d3e190885a2c83c209a84" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1c/classsort__stream__i.html#903962d0397d3e190885a2c83c209a84">is_sorted</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sort happens at first get_next call, returns false until then. <br></td></tr>
<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static PFC&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1c/classsort__stream__i.html#962999debaf4f32a560c8f39d618e01e">get_cmp_func</a> (<a class="el" href="../../d1/dbb/structssm__sort_1_1key__info__t.html#8dee46e185d103f61e5a1f65219ca189">key_info_t::key_type_t</a> type, bool up)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a key-comparison function for the given pre-defined key type.  <a href="#962999debaf4f32a560c8f39d618e01e"></a><br></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="7af2cc223299f447fe3a01a54f17b5ae"></a><!-- doxytag: member="sort_stream_i::sort_stream_i" ref="7af2cc223299f447fe3a01a54f17b5ae" args="(const key_info_t &amp;k, const sort_parm_t &amp;s, uint est_rec_sz=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NORET sort_stream_i::sort_stream_i           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/dbb/structssm__sort_1_1key__info__t.html">key_info_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d66/structssm__sort_1_1sort__parm__t.html">sort_parm_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&nbsp;</td>
          <td class="paramname"> <em>est_rec_sz</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor that calls <a class="el" href="../../da/d1c/classsort__stream__i.html#5a9882fa322ec456f0e44720dfc5ec27">init()</a>. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>k</em>&nbsp;</td><td>See key_info_t, which describes the keys used to sort the data to be inserted. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td>See <a class="el" href="../../db/d66/structssm__sort_1_1sort__parm__t.html">ssm_sort::sort_parm_t</a>, which describes behavior of the sort. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>est_rec_sz</em>&nbsp;</td><td>Estimated record size; allows the sort to estimate how many items will fit in a page. </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="962999debaf4f32a560c8f39d618e01e"></a><!-- doxytag: member="sort_stream_i::get_cmp_func" ref="962999debaf4f32a560c8f39d618e01e" args="(key_info_t::key_type_t type, bool up)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static PFC sort_stream_i::get_cmp_func           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/dbb/structssm__sort_1_1key__info__t.html#8dee46e185d103f61e5a1f65219ca189">key_info_t::key_type_t</a>&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>up</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return a key-comparison function for the given pre-defined key type. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>See key_info_t. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>up</em>&nbsp;</td><td>If true, the function returns will sort in ascending order, if false, in descending order. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="5a9882fa322ec456f0e44720dfc5ec27"></a><!-- doxytag: member="sort_stream_i::init" ref="5a9882fa322ec456f0e44720dfc5ec27" args="(const key_info_t &amp;k, const sort_parm_t &amp;s, uint est_rec_sz=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sort_stream_i::init           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/dbb/structssm__sort_1_1key__info__t.html">key_info_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d66/structssm__sort_1_1sort__parm__t.html">sort_parm_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&nbsp;</td>
          <td class="paramname"> <em>est_rec_sz</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize the stream with necessary metadata. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>k</em>&nbsp;</td><td>See key_info_t, which describes the keys used to sort the data to be inserted. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td>See <a class="el" href="../../db/d66/structssm__sort_1_1sort__parm__t.html">ssm_sort::sort_parm_t</a>, which describes behavior of the sort. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>est_rec_sz</em>&nbsp;</td><td>Estimated record size; allows the sort to estimate how many items will fit in a page. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="f248b78ad8e2636783f3ba44f3d83bde"></a><!-- doxytag: member="sort_stream_i::put" ref="f248b78ad8e2636783f3ba44f3d83bde" args="(const cvec_t &amp;key, const cvec_t &amp;elem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> sort_stream_i::put           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d9/da4/classcvec__t.html">cvec_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/da4/classcvec__t.html">cvec_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>elem</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Insert a key,elem pair into the stream. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>Key of key,elem pair. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>elem</em>&nbsp;</td><td>Element of key,elem pair.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Note:</b></dt><dd>Must be invoked in a transaction, although this is not enforced gracefully. </dd></dl>

</div>
</div><p>
<a class="anchor" name="912549730adfcf5235ef72ac37bf9d95"></a><!-- doxytag: member="sort_stream_i::get_next" ref="912549730adfcf5235ef72ac37bf9d95" args="(vec_t &amp;key, vec_t &amp;elem, bool &amp;eof)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../db/dc7/classw__rc__t.html">rc_t</a> sort_stream_i::get_next           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/ddb/classvec__t.html">vec_t</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&nbsp;</td>
          <td class="paramname"> <em>eof</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Fetch the next key,elem pair from the stream (in sorted order). 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>key</em>&nbsp;</td><td>Key of key,elem pair. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>elem</em>&nbsp;</td><td>Element of key,elem pair. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>eof</em>&nbsp;</td><td>Set to true if no more pairs in the stream.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Note:</b></dt><dd>Must be invoked in a transaction, although this is not enforced gracefully. </dd></dl>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>src/sm/<a class="el" href="../../d5/d96/sort_8h-source.html">sort.h</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jan 2 15:14:13 2012 for Shore Storage Manager by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
