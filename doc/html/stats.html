<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Shore Storage Manager: Sets of Statistics</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<h1><a class="anchor" name="STATS">Sets of Statistics</a></h1>Each library (and the client, if you so choose) may have its own collection of statistics. To enable rapid addition and modifying of the counters kept, a Perl script takes a brief description of the statistics and genenerates a series of files for including in your source code.<h2><a class="anchor" name="STATSOUT">
Output</a></h2>
The Perl script stats.pl in tools/ takes a file (usually named something like xxx_stats.dat) of the form: <div class="fragment"><pre class="fragment"> name1 name2 = mask <span class="keyword">class </span>{
    type STATNAME    Descriptive string
    type STATNAME    Descriptive string
     ...
    type STATNAME    Descriptive string
    }
</pre></div><p>
<ul>
<li>"name1" and "name2" are no longer used by the storage manager, but must be present.</li></ul>
<p>
<ul>
<li>"mask" can be in octal (0777777), hex (0xabcdeff) or decimal notation. It should be unique among statistics modules. It is no longer used by the storage manager but must be present.</li></ul>
<p>
<ul>
<li>"class" is required. Output file names contain the class name as a prefix.</li></ul>
<p>
<ul>
<li>"type" must be a one-word type:<ul>
<li>base_stat, unsigned int, unsigned long, unsigned, u_int, u_long, int, long, ulong are synonyms for base_stat_t</li><li>float, base_float, and double are synonyms for base_float_t</li></ul>
</li></ul>
<p>
<ul>
<li>STATNAME is the attribute name of the counter in the C++ class. These attribute names are generated in the output for inclusion in code that declares the class.</li></ul>
<p>
<ul>
<li>"Descriptive string" will be quoted by the translator. Don't put it in quotes in the .dat file.</li></ul>
<h2><a class="anchor" name="STATSOUT">
Output</a></h2>
for each class this script creates:<p>
<ul>
<li>&lt;class&gt;_dec_gen.cpp : definition of &lt;class&gt;&amp; operator -= (&lt;class&gt; &amp;, const &lt;class&gt; &amp;);</li><li>&lt;class&gt;_inc_gen.cpp : definition of &lt;class&gt;&amp; operator += (&lt;class&gt; &amp;, const &lt;class&gt; &amp;);</li><li>&lt;class&gt;_out_gen.cpp : definition of &lt;class&gt;&amp; operator &lt;&lt; (ostream &amp;, const &lt;class&gt; &amp;);</li><li>&lt;class&gt;_collect_gen.cpp : contains code used by virtual table code. Not for general use.</li><li>&lt;class&gt;_struct_gen.h : contains list of attribute members for the class:w</li><li>&lt;class&gt;_collect_enum_gen.h : Enumeration values used by virtual table code. Not for general use.</li><li>&lt;class&gt;_msg_gen.h : the descriptive strings.</li></ul>
<p>
Use as follows: <div class="fragment"><pre class="fragment">  <span class="keyword">class </span>\&lt;class\&gt; {
  <span class="keyword">public</span>:
<span class="preprocessor">  #include "&lt;class\&gt;</span>_struct_gen.h<span class="stringliteral">"</span>
<span class="stringliteral">      &lt;class&gt;() { ... }</span>
<span class="stringliteral">      ~&lt;class&gt;() { ... }</span>
<span class="stringliteral">      void clear() {</span>
<span class="stringliteral">          memset((void *)this, '\0', sizeof(*this));</span>
<span class="stringliteral">      }</span>
<span class="stringliteral">  };</span>
<span class="stringliteral"></span>
<span class="stringliteral">  #include "</span>\&lt;<span class="keyword">class</span>\&gt;_inc_gen.cpp<span class="stringliteral">"</span>
<span class="stringliteral">  #include "</span>\&lt;<span class="keyword">class</span>\&gt;_dec_gen.cpp<span class="stringliteral">"</span>
<span class="stringliteral">  #include "</span>\&lt;<span class="keyword">class</span>\&gt;_out_gen.cpp<span class="stringliteral">"</span>
<span class="stringliteral"></span>
<span class="stringliteral">  const char *&lt;class&gt;::stat_names[] = {</span>
<span class="stringliteral">  #include "</span>\&lt;<span class="keyword">class</span>\&gt;_msg_gen.h<span class="stringliteral">"</span>
<span class="stringliteral">  }</span>
</pre></div> <hr size="1"><address style="align: right;"><small>Generated on Mon Jan 2 15:13:58 2012 for Shore Storage Manager by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
