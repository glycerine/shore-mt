<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Shore Storage Manager: lsn_t Class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="../../modules.html"><span>Modules</span></a></li>
    <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
    <li id="current"><a href="../../classes.html"><span>Classes</span></a></li>
    <li><a href="../../files.html"><span>Files</span></a></li>
    <li><a href="../../dirs.html"><span>Directories</span></a></li>
    <li><a href="../../pages.html"><span>Related&nbsp;Pages</span></a></li>
    <li><a href="../../examples.html"><span>Examples</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="../../classes.html"><span>Alphabetical&nbsp;List</span></a></li>
    <li><a href="../../annotated.html"><span>Class&nbsp;List</span></a></li>
    <li><a href="../../hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
    <li><a href="../../functions.html"><span>Class&nbsp;Members</span></a></li>
  </ul></div>
<h1>lsn_t Class Reference<br>
<small>
[<a class="el" href="../../df/db2/group___l_s_n_s.html">How Log Sequence Numbers are Used</a>]</small>
</h1><!-- doxytag: class="lsn_t" -->Inherited by <a class="el" href="../../d1/da9/classsm__save__point__t.html">sm_save_point_t</a>.
<p>
Inheritance diagram for lsn_t:<p><center><img src="../../de/d58/classlsn__t__inherit__graph.png" border="0" usemap="#db/d61/lsn__t__inherit__map" alt="Inheritance graph"></center>
<map name="db/d61/lsn__t__inherit__map">
<area href="../../d1/da9/classsm__save__point__t.html" shape="rect" coords="5,80,133,107" alt="">
</map>
<center><font size="2">[<a target="top" href="../../graph_legend.html">legend</a>]</font></center>Collaboration diagram for lsn_t:<p><center><img src="../../db/d41/classlsn__t__coll__graph.png" border="0" usemap="#d3/de2/lsn__t__coll__map" alt="Collaboration graph"></center>
<center><font size="2">[<a target="top" href="../../graph_legend.html">legend</a>]</font></center><a href="../../d5/d33/classlsn__t-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
Log Sequence Number. See <a class="el" href="../../implnotes.html#LSNS">Log Sequence Numbers</a>. 
<p>
A log sequence number points to a record in the log. It consists of two parts:<ul>
<li><a class="el" href="../../d2/d19/classlsn__t.html#997ad0a25535bf9ea5533112a42bbd09">hi()</a>, a.k.a., <a class="el" href="../../d2/d19/classlsn__t.html#93d3a349f5e07f08207870b5f104808f">file()</a>. This is a number that matches a log partition file, e.g., "log.&lt;file&gt;"</li><li><a class="el" href="../../d2/d19/classlsn__t.html#56f78347505351712c785c6ad3f32cb0">lo()</a>, a.k.a., <a class="el" href="../../d2/d19/classlsn__t.html#bae3d36388cb5360ef9fd249f7e48ac9">rba()</a>. This is byte-offset into the log partition, and is the first byte of a log record, or is the first byte after the last log record in the file (where the next log record could be written).</li></ul>
<p>
All state is stored in a single 64-bit value. This reading or setting is atomic on 64-bit platforms (though updates still need protection). <dl compact><dt><b>Warning:</b></dt><dd>This is NOT atomic on 32-bit platforms.</dd></dl>
Because all state fits in 64 bits, there is a trade-off between maximum supported log partition size and number of partitions. Two reasonable choices are:<p>
<ul>
<li>16-bit partition numbers, up to 256TB per partition</li><li>32-bit partition numbers, up to 4GB per partition</li></ul>
<p>
48-bit offsets are larger, but (slightly) more expensive and likely to wrap sooner. 32-bit offsets are still pretty big, and the chance of wrapping is *much* smaller (though a production system could theoretically hit the limit, since the count persists as long as the database exists. For now we go with the 32-32 split.<p>
<a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> no longer cares whether the disk can handle the full range it supports. If you support 48-bit partition sizes and the disk can only handle 32-bit offsets, the largest file will just happen to be smaller than <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> technically supports.<p>
<a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> does not cater to unaligned accesses. Log writes, in particular, are expected to be 8-byte aligned. The extra wasted bytes just aren't worth the performance hit of allowing misalignment.<p>
<dl compact><dt><b>Note:</b></dt><dd>Once the database runs long enough we will run out of partition numbers (only 64k possible). Fortunately, this is a log, so <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> don't last forever. Eventually things become durable and the log partition file gets reclaimed (deleted). As long as the first partition is gone before the last one fills, we can simply wrap and change the sense of <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> comparisions. </dd></dl>
<dl compact><dt><b>Examples: </b></dt><dd>

<p>
<a class="el" href="../../d0/d88/log__exceed_8cpp-example.html#_a119">log_exceed.cpp</a>.</dl>
<p>

<p>
Definition at line <a class="el" href="../../d3/d25/lsn_8h-source.html#l00236">236</a> of file <a class="el" href="../../d3/d25/lsn_8h-source.html">lsn.h</a>.<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"></td></tr>

<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="43d4cbd8026544c22d953cbb3f83b434"></a><!-- doxytag: member="lsn_t::lsn_t" ref="43d4cbd8026544c22d953cbb3f83b434" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#43d4cbd8026544c22d953cbb3f83b434">lsn_t</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ebc788368eb7028739137c8689b5f41d"></a><!-- doxytag: member="lsn_t::lsn_t" ref="ebc788368eb7028739137c8689b5f41d" args="(w_base_t::uint4_t f, sm_diskaddr_t r)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#ebc788368eb7028739137c8689b5f41d">lsn_t</a> (<a class="el" href="../../d9/da0/classw__base__t.html#7d1c7ae407200662fd16b64de4dcde46">w_base_t::uint4_t</a> f, sm_diskaddr_t r)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ff6f338c7d83ef8b2d19deb4b1f88d4d"></a><!-- doxytag: member="lsn_t::lsn_t" ref="ff6f338c7d83ef8b2d19deb4b1f88d4d" args="(const lsn_t &amp;other)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#ff6f338c7d83ef8b2d19deb4b1f88d4d">lsn_t</a> (const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;other)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="71f18f64cc418f5427df8e3d31a2aae8"></a><!-- doxytag: member="lsn_t::valid" ref="71f18f64cc418f5427df8e3d31a2aae8" args="() const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#71f18f64cc418f5427df8e3d31a2aae8">valid</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="997ad0a25535bf9ea5533112a42bbd09"></a><!-- doxytag: member="lsn_t::hi" ref="997ad0a25535bf9ea5533112a42bbd09" args="() const " -->
<a class="el" href="../../d9/da0/classw__base__t.html#7d1c7ae407200662fd16b64de4dcde46">w_base_t::uint4_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#997ad0a25535bf9ea5533112a42bbd09">hi</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="93d3a349f5e07f08207870b5f104808f"></a><!-- doxytag: member="lsn_t::file" ref="93d3a349f5e07f08207870b5f104808f" args="() const " -->
<a class="el" href="../../d9/da0/classw__base__t.html#7d1c7ae407200662fd16b64de4dcde46">w_base_t::uint4_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#93d3a349f5e07f08207870b5f104808f">file</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="56f78347505351712c785c6ad3f32cb0"></a><!-- doxytag: member="lsn_t::lo" ref="56f78347505351712c785c6ad3f32cb0" args="() const " -->
sm_diskaddr_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#56f78347505351712c785c6ad3f32cb0">lo</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bae3d36388cb5360ef9fd249f7e48ac9"></a><!-- doxytag: member="lsn_t::rba" ref="bae3d36388cb5360ef9fd249f7e48ac9" args="() const " -->
sm_diskaddr_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#bae3d36388cb5360ef9fd249f7e48ac9">rba</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8a95ca73a6047d5172047efbf5b4b513"></a><!-- doxytag: member="lsn_t::copy_rba" ref="8a95ca73a6047d5172047efbf5b4b513" args="(const lsn_t &amp;other)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#8a95ca73a6047d5172047efbf5b4b513">copy_rba</a> (const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;other)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="21f8380ee2e20ac0df620dc28ae1a5cb"></a><!-- doxytag: member="lsn_t::set_rba" ref="21f8380ee2e20ac0df620dc28ae1a5cb" args="(sm_diskaddr_t &amp;other)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#21f8380ee2e20ac0df620dc28ae1a5cb">set_rba</a> (sm_diskaddr_t &amp;other)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a622b82216564a988685b942d0127dba"></a><!-- doxytag: member="lsn_t::advance" ref="a622b82216564a988685b942d0127dba" args="(int amt)" -->
<a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#a622b82216564a988685b942d0127dba">advance</a> (int amt)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="97c94f0744bf0da6de50b59016f42c90"></a><!-- doxytag: member="lsn_t::operator+=" ref="97c94f0744bf0da6de50b59016f42c90" args="(long delta)" -->
<a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#97c94f0744bf0da6de50b59016f42c90">operator+=</a> (long delta)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="455fc3b8745416e55b3b92c0c97cb040"></a><!-- doxytag: member="lsn_t::operator+" ref="455fc3b8745416e55b3b92c0c97cb040" args="(long delta) const " -->
<a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#455fc3b8745416e55b3b92c0c97cb040">operator+</a> (long delta) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dd3a0cb6468f555315844a84576ad73b"></a><!-- doxytag: member="lsn_t::operator&gt;" ref="dd3a0cb6468f555315844a84576ad73b" args="(const lsn_t &amp;l) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#dd3a0cb6468f555315844a84576ad73b">operator&gt;</a> (const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;l) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b06d56180b6daafef3b5f4b0409b7168"></a><!-- doxytag: member="lsn_t::operator&lt;" ref="b06d56180b6daafef3b5f4b0409b7168" args="(const lsn_t &amp;l) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#b06d56180b6daafef3b5f4b0409b7168">operator&lt;</a> (const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;l) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="52cee77230eb9edeaa235d8cbad7d403"></a><!-- doxytag: member="lsn_t::operator&gt;=" ref="52cee77230eb9edeaa235d8cbad7d403" args="(const lsn_t &amp;l) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#52cee77230eb9edeaa235d8cbad7d403">operator&gt;=</a> (const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;l) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f1582da787f42649b3d24097c689c84f"></a><!-- doxytag: member="lsn_t::operator&lt;=" ref="f1582da787f42649b3d24097c689c84f" args="(const lsn_t &amp;l) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#f1582da787f42649b3d24097c689c84f">operator&lt;=</a> (const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;l) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="243567d6cba6a8580c8ef901ff52527f"></a><!-- doxytag: member="lsn_t::operator==" ref="243567d6cba6a8580c8ef901ff52527f" args="(const lsn_t &amp;l) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#243567d6cba6a8580c8ef901ff52527f">operator==</a> (const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;l) const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d08eb5b755ec95b62c2706a0fc3d8860"></a><!-- doxytag: member="lsn_t::operator!=" ref="d08eb5b755ec95b62c2706a0fc3d8860" args="(const lsn_t &amp;l) const " -->
bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#d08eb5b755ec95b62c2706a0fc3d8860">operator!=</a> (const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a> &amp;l) const </td></tr>

<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2dd05a86501cabc7041b2891bcbec72a"></a><!-- doxytag: member="lsn_t::mask" ref="2dd05a86501cabc7041b2891bcbec72a" args="()" -->
static w_base_t::uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#2dd05a86501cabc7041b2891bcbec72a">mask</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8277612c4d116d1129f329bc11a5bd73"></a><!-- doxytag: member="lsn_t::sm_diskaddr_max" ref="8277612c4d116d1129f329bc11a5bd73" args="" -->
static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#8277612c4d116d1129f329bc11a5bd73">sm_diskaddr_max</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7500d912c84458653301cd0fa73145ab"></a><!-- doxytag: member="lsn_t::null" ref="7500d912c84458653301cd0fa73145ab" args="" -->
static const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#7500d912c84458653301cd0fa73145ab">null</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="254df2d335744c6a2f95d11baf774ed3"></a><!-- doxytag: member="lsn_t::max" ref="254df2d335744c6a2f95d11baf774ed3" args="" -->
static const <a class="el" href="../../d2/d19/classlsn__t.html">lsn_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d19/classlsn__t.html#254df2d335744c6a2f95d11baf774ed3">max</a></td></tr>

</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li>src/common/<a class="el" href="../../d3/d25/lsn_8h-source.html">lsn.h</a><li>src/common/<a class="el" href="../../d0/d67/lsn_8cpp-source.html">lsn.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Mon Jan 2 15:14:08 2012 for Shore Storage Manager by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
